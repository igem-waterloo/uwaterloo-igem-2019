import requests
import urllib.request
import time
from bs4 import BeautifulSoup
from bs4.element import Comment
from collections import Counter
import string
import nltk
from fuzzywuzzy import fuzz
from fuzzywuzzy import process
from geopy.geocoders import GoogleV3
import json
import plotly.graph_objects as go
import pandas as pd
from requests.adapters import HTTPAdapter
from requests.packages.urllib3.util.retry import Retry
#14.207.28.100
proxy_ip = "152.249.249.246"
proxy_port = "8080"
proxies = {
    "http": 'http://' + proxy_ip + ':' + proxy_port, 
    "https": 'http://' + proxy_ip + ':' + proxy_port
}

print(proxies)
session = requests.Session()
session.proxies.update(proxies)
retry = Retry(connect=3, backoff_factor=0.5)
adapter = HTTPAdapter(max_retries=retry)
session.mount('http://', adapter)
session.mount('https://', adapter)

url = 'https://httpbin.org/ip'
response = session.get(url)
print(response.json())
# import sys
# sys.exit()





# Example geocode
# location = geolocator.geocode("Washington", language='en')
# if location != None:
#     print (json.dumps(location.raw, indent=4))
#     print (location.address)
# else:
#     print ("No location!" , location)

# nltk.download('averaged_perceptron_tagger')
import time
print("Starting script.")
geo_from_json = {'Aachen': {'lat': 50.7772326, 'lng': 6.0476303}, 'Aalto-Helsinki': {'lat': 60.18364619999999, 'lng': 24.8243817}, 'AHUT_China': {'lat': 31.692956, 'lng': 118.510711}, 'Ain_Shams': {'lat': 30.0759774, 'lng': 31.28111879999999}, 'Aix-Marseille': {'lat': 43.2563637, 'lng': 5.4049358}, 'Alberta': {'lat': 53.5285415, 'lng': -113.5281231}, 'Alverno_CA': {'lat': 34.1659526, 'lng': -118.0666939}, 'Arizona_State': {'lat': 33.4201172, 'lng': -111.9321364}, 'ASIJ_Tokyo': {'lat': 35.6809719, 'lng': 139.5213319}, 'ATOMS_Turkiye': {'lat': 39.9905034, 'lng': 32.6955445}, 'AUC_TURKEY': {'lat': 39.9905034, 'lng': 32.6955445}, 'Austin_UTexas': {'lat': 30.2884658, 'lng': -97.73710950000002}, 'Austin_UTexas_LASA': {'lat': 30.2849185, 'lng': -97.7340567}, 'BGI_COLLEGE': {'lat': 22.458906, 'lng': 114.184336}, 'BGU_ISRAEL': {'lat': 31.252973, 'lng': 34.791462}, 'BHU_China': {'lat': 39.90009, 'lng': 116.384132}, 'Bielefeld-CeBiTec': {'lat': 52.0393272, 'lng': 8.4909501}, 'Bilkent-UNAMBG': {'lat': 39.86769899999999, 'lng': 32.747576}, 'BioBricks': {'lat': 37.42907659999999, 'lng': -122.1754159}, 'BIOSINT_Mexico': {'lat': 20.612562, 'lng': -100.4052182}, 'BIT': {'lat': 39.983326, 'lng': 116.312485}, 'BIT-China': {'lat': 39.9660282, 'lng': 116.3229234}, 'BNDS_China': {'lat': 39.902615, 'lng': 116.255987}, 'BNU-China': {'lat': 39.96212, 'lng': 116.3661299}, 'Bordeaux': {'lat': 44.803301, 'lng': -0.6112402}, 'BostonU': {'lat': 42.3504997, 'lng': -71.1053991}, 'BostonU_HW': {'lat': 42.3492358, 'lng': -71.1066377}, 'British_Columbia': {'lat': 49.262361, 'lng': -123.244944}, 'BroadRun-NorthernVA': {'lat': 39.2941707, 'lng': -76.56227919999999}, 'Bulgaria': {'lat': 42.6570607, 'lng': 23.3551086}, 'Cambridge-JIC': {'lat': 52.20262400000001, 'lng': 0.1215365}, 'Cardiff_Wales': {'lat': 51.4882129, 'lng': -3.1802354}, 'CCA_SanDiego': {'lat': 32.9590757, 'lng': -117.1894334}, 'Central-Calgary': {'lat': 51.007999, 'lng': -114.112302}, 'CIEI-BJ': {'lat': 39.912288, 'lng': 116.365867}, 'CLS-London-UK': {'lat': 39.912288, 'lng': 116.365867}, 'CLSB-UK': {'lat': 51.5119213, 'lng': -0.096925}, 'ColegioFDR_Peru': {'lat': -12.0958188, 'lng': -77.0145608}, 'CoLite-West-Point': {'lat': 41.43041789999999, 'lng': -74.00063279999999}, 'ColumbiaU_NYC': {'lat': 40.8393915, 'lng': -73.9403092}, 'Concordia': {'lat': 45.4945643, 'lng': -73.5773775}, 'Cornell_NY': {'lat': 42.44684549999999, 'lng': -76.4774839}, 'CPU_CHINA': {'lat': 31.9007409, 'lng': 118.9199359}, 'CSU_Fort_Collins': {'lat': 40.5690946, 'lng': -105.0792269}, 'CU-Boulder': {'lat': 40.0086516, 'lng': -105.2682135}, 'Dalhousie_Halifax_NS': {'lat': 44.637651, 'lng': -63.58290879999999}, 'Denver_Biolabs': {'lat': 39.7219611, 'lng': -104.99057}, 'DTU-Denmark': {'lat': 55.787537, 'lng': 12.5182208}, 'Duesseldorf': {'lat': 51.1888113, 'lng': 6.794503}, 'Duke': {'lat': 36.005014, 'lng': -78.9406389}, 'Dundee': {'lat': 56.4580845, 'lng': -2.9858335}, 'Dundee_Schools': {'lat': 56.4580845, 'lng': -2.9858335}, 'Edinburgh_OG': {'lat': 55.9242646, 'lng': -3.1791194}, 'Edinburgh_UG': {'lat': 55.9242646, 'lng': -3.1791194}, 'Emory': {'lat': 33.7966688, 'lng': -84.3231905}, 'EPFL': {'lat': 46.5201012, 'lng': 6.5639207}, 'Ethiopia1': {'lat': 13.4799262, 'lng': 39.4849384}, 'ETH_Zurich': {'lat': 47.566553, 'lng': 7.602361999999999}, 'Evry': {'lat': 48.6181797, 'lng': 2.4484425}, 'Exeter': {'lat': 50.73666069999999, 'lng': -3.5351155}, 'FAFU-CHINA': {'lat': 26.0784409, 'lng': 119.2761369}, 'FAU_Erlangen': {'lat': 49.5793322, 'lng': 11.0303807}, 'Freiburg': {'lat': 48.00125, 'lng': 7.850110000000001}, 'Fudan': {'lat': 31.2974197, 'lng': 121.5036178}, 'Gaston_Day': {'lat': 35.2016479, 'lng': -81.1412247}, 'GDSYZX-United': {'lat': 23.0965384, 'lng': 113.298883}, 'Genspace': {'lat': 40.6877184, 'lng': -73.9797995}, 'Georgia_State': {'lat': 33.7507688, 'lng': -84.38555339999999}, 'Gifu': {'lat': 35.4662236, 'lng': 136.7365752}, 'Glasgow': {'lat': 55.8725956, 'lng': -4.2857091}, 'Goettingen': {'lat': 51.55895, 'lng': 9.95233}, 'Graz': {'lat': 47.065093, 'lng': 15.4528574}, 'Groningen': {'lat': 53.241243, 'lng': 6.5384835}, 'GTO_Mx': {'lat': 20.7591739, 'lng': -101.3366762}, 'Hamburg': {'lat': 53.5678414, 'lng': 9.978160899999999}, 'Hannover': {'lat': 52.3829641, 'lng': 9.7196989}, 'Harvard_BioDesign': {'lat': 42.3770029, 'lng': -71.11666009999999}, 'HFUT-China': {'lat': 31.847443, 'lng': 117.295572}, 'HokkaidoU_Japan': {'lat': 43.07194399999999, 'lng': 141.3417219}, 'Hong_Kong_HKU': {'lat': 22.268743, 'lng': 114.128461}, 'Hong_Kong_HKUST': {'lat': 22.3185673, 'lng': 114.1796057}, 'Hong_Kong_UCCKE': {'lat': 22.331036, 'lng': 114.2223784}, 'HSiTAIWAN': {'lat': 25.033657, 'lng': 121.5404217}, 'HUST-China': {'lat': 30.5130043, 'lng': 114.4202756}, 'HZAU-China': {'lat': 30.475126, 'lng': 114.353035}, 'IISc_Bangalore': {'lat': 13.0236924, 'lng': 77.5635302}, 'IIT-Madras': {'lat': 12.9894473, 'lng': 80.22762870000001}, 'IIT_Delhi': {'lat': 12.9894473, 'lng': 80.22762870000001}, 'IIT_Kharagpur': {'lat': 22.3179865, 'lng': 87.31152}, 'IMPACT_': {'lat': 48.856614, 'lng': 2.3522219}, 'Imperial_College': {'lat': 51.49879970000001, 'lng': -0.1748772}, 'India-Thapar-CSED': {'lat': 30.3529716, 'lng': 76.3710378}, 'INSA-Lyon': {'lat': 45.7833244, 'lng': 4.8781984}, 'Ionis_Paris': {'lat': 48.79814150000001, 'lng': 2.3571471}, 'Istanbul_Tech': {'lat': 41.0082376, 'lng': 28.9783589}, 'IvyTech_SouthBend_IN': {'lat': 41.6614794, 'lng': -86.24807969999999}, 'Jilin_China': {'lat': 43.82572, 'lng': 125.2850161}, 'JNFLS_China': {'lat': 36.64893, 'lng': 117.029014}, 'JSNU-China': {'lat': 34.198426, 'lng': 117.184271}, 'JSNU_CHINA': {'lat': 34.197866, 'lng': 117.186297}, 'Judd_UK': {'lat': 51.1876031, 'lng': 0.2641003}, 'KAIT_Japan': {'lat': 35.4865554, 'lng': 139.3432554}, 'Kent': {'lat': 51.2977526, 'lng': 1.065526}, 'Kingsborough_NY': {'lat': 40.5778144, 'lng': -73.9355607}, 'KoreaSonyeodul': {'lat': 37.3301408, 'lng': 127.2560102}, 'Korea_U_Seoul': {'lat': 37.590799, 'lng': 127.0277773}, 'Kyoto': {'lat': 35.0198419, 'lng': 135.7742164}, 'LambertGA': {'lat': 34.10687800000001, 'lng': -84.13823699999999}, 'Lanzhou': {'lat': 36.0477699, 'lng': 103.8585624}, 'Leicester': {'lat': 52.6210651, 'lng': -1.1244304}, 'Leiden': {'lat': 52.1684772, 'lng': 4.467035699999999}, 'Lethbridge': {'lat': 49.676651, 'lng': -112.8624304}, 'Lethbridge_HS': {'lat': 49.676651, 'lng': -112.8624304}, 'Liceo_Eugenio_Hostos': {'lat': -33.4426767, 'lng': -70.5418133}, 'Linkoping_Sweden': {'lat': 58.3978364, 'lng': 15.5760072}, 'LMU-TUM_Munich': {'lat': 48.39854589999999, 'lng': 11.7235551}, 'LN-Shiyan-China': {'lat': 41.834497, 'lng': 123.420248}, 'Lubbock_TTU': {'lat': 33.5842591, 'lng': -101.8782822}, 'Macquarie_Australia': {'lat': -33.77382370000001, 'lng': 151.1126498}, 'Manchester': {'lat': 53.4733457, 'lng': -2.235812}, 'Marburg': {'lat': 50.8068182, 'lng': 8.810895}, 'McGill-McMaster': {'lat': 45.5065979, 'lng': -73.5787411}, 'McMasterU': {'lat': 43.2621253, 'lng': -79.9201781}, 'Melbourne': {'lat': -37.799527, 'lng': 144.958739}, 'METU_HS_Ankara': {'lat': 39.9333635, 'lng': 32.8597419}, 'Michigan': {'lat': 42.2798609, 'lng': -83.7352502}, 'Michigan_Software': {'lat': 42.2798609, 'lng': -83.7352502}, 'Mingdao': {'lat': 24.1060389, 'lng': 120.6359039}, 'Minnesota': {'lat': 44.9857375, 'lng': -93.1822814}, 'Missouri_Rolla': {'lat': 37.9528228, 'lng': -91.7738192}, 'MIT': {'lat': 42.3633736, 'lng': -71.0925996}, 'MSU-Michigan': {'lat': 42.7231799, 'lng': -84.47547790000002}, 'Nagahama': {'lat': 35.3562983, 'lng': 136.282051}, 'Nanjing-China': {'lat': 32.129771, 'lng': 118.958493}, 'Nanjing_NFLS': {'lat': 32.0351409, 'lng': 118.766711}, 'NAU-CHINA': {'lat': 32.033399, 'lng': 118.842587}, 'NCKU_Tainan': {'lat': 22.9988416, 'lng': 120.2195148}, 'NCL_India': {'lat': 18.547456, 'lng': 73.8076288}, 'NCTU_Formosa': {'lat': 24.7859852, 'lng': 120.9999097}, 'NEFU_China': {'lat': 45.7193338, 'lng': 126.6489048}, 'NEU-China': {'lat': 41.8058951, 'lng': 123.4321096}, 'Newcastle': {'lat': 54.9823138, 'lng': -1.6236916}, 'NJU-China': {'lat': 32.2173172, 'lng': 118.8317561}, 'NKU_China': {'lat': 39.10394429999999, 'lng': 117.1742232}, 'NorthernBC': {'lat': 53.8929819, 'lng': -122.8131555}, 'Northwestern': {'lat': 42.0578383, 'lng': -87.6761566}, 'NRP-UEA-Norwich': {'lat': 52.6206274, 'lng': 1.2360712}, 'NTHU_Taiwan': {'lat': 24.8138287, 'lng': 120.9674798}, 'NTNU_Trondheim': {'lat': 63.4305149, 'lng': 10.3950528}, 'NTU-Singapore': {'lat': 1.345418, 'lng': 103.679045}, 'NUDT_CHINA': {'lat': 28.2230501, 'lng': 113.0045521}, 'NUS_Singapore': {'lat': 1.2967963, 'lng': 103.7802672}, 'NWPU': {'lat': 34.24118540000001, 'lng': 108.9683609}, 'NYMU-Taipei': {'lat': 25.123002, 'lng': 121.513702}, 'NYU-AD': {'lat': 24.453884, 'lng': 54.3773438}, 'NYU_Shanghai': {'lat': 31.2249929, 'lng': 121.533757}, 'OLS_Canmore': {'lat': 51.049558, 'lng': -115.3183929}, 'OUC-China': {'lat': 36.061255, 'lng': 120.335301}, 'Oxford': {'lat': 51.7593835, 'lng': -1.255015}, 'Paris_Bettencourt': {'lat': 48.83755499999999, 'lng': 2.3385292}, 'Paris_Saclay': {'lat': 48.856614, 'lng': 2.3522219}, 'Pasteur_Paris': {'lat': 48.8403734, 'lng': 2.3112488}, 'Peking': {'lat': 39.992306, 'lng': 116.31677}, 'Peshawar': {'lat': 33.9744107, 'lng': 71.4358733}, 'Pittsburgh': {'lat': 40.4425606, 'lng': -79.9609827}, 'Pretoria_UP': {'lat': -25.7564139, 'lng': 28.2365133}, 'Purdue': {'lat': 40.4229204, 'lng': -86.9233974}, 'Queens_Canada': {'lat': 44.2243383, 'lng': -76.491596}, 'RHIT': {'lat': 39.4828386, 'lng': -87.3240403}, 'Rice': {'lat': 29.7173941, 'lng': -95.40183119999999}, 'Richard_Montgomery': {'lat': 39.078393, 'lng': -77.1467492}, 'Rock_Ridge_Virginia': {'lat': 38.9778724, 'lng': -77.5000178}, 'Ryerson_Toronto': {'lat': 43.65829859999999, 'lng': -79.3807846}, 'Saint_Rose_School': {'lat': -33.4488897, 'lng': -70.6692655}, 'Saint_Rose_School_B': {'lat': -33.4488897, 'lng': -70.6692655}, 'SCAU-China': {'lat': 23.156792, 'lng': 113.351806}, 'SCSU-New Haven': {'lat': 41.3323299, 'lng': -72.94980490000002}, 'SCU-China': {'lat': 30.663964, 'lng': 104.071022}, 'SCUT': {'lat': 23.151326, 'lng': 113.344683}, 'SCUT-China': {'lat': 23.151326, 'lng': 113.344683}, 'SDSZ_CHINA': {'lat': 39.91171800000001, 'lng': 116.367989}, 'SDU-Denmark': {'lat': 55.3683771, 'lng': 10.4270615}, 'ShanghaitechChina': {'lat': 31.1763741, 'lng': 121.5924518}, 'ShanghaiTechChina_B': {'lat': 31.1763741, 'lng': 121.5924518}, 'Sheffield': {'lat': 53.3814356, 'lng': -1.4884349}, 'Shenzhen_SFLS': {'lat': 22.458906, 'lng': 114.184336}, 'SJTU-BioX-Shanghai': {'lat': 31.023856, 'lng': 121.441631}, 'SJTU-Software': {'lat': 31.023856, 'lng': 121.441631}, 'Slovenia': {'lat': 46.0428055, 'lng': 14.4941228}, 'SMS_Shenzhen': {'lat': 22.551243, 'lng': 114.121419}, 'SPS_singapore': {'lat': 22.551243, 'lng': 114.121419}, 'SRM_Chennai': {'lat': 12.8231446, 'lng': 80.045802}, 'Stanford-Brown': {'lat': 37.4088478, 'lng': -122.0644229}, 'Stockholm': {'lat': 59.32932349999999, 'lng': 18.0685808}, 'Stony_Brook': {'lat': 40.9123761, 'lng': -73.1233889}, 'StuyGem': {'lat': 40.7181492, 'lng': -74.0137623}, 'SUSTech_Shenzhen': {'lat': 22.592429, 'lng': 113.999665}, 'SVCE_CHENNAI': {'lat': 12.9834048, 'lng': 79.9699387}, 'Sydney_Australia': {'lat': -33.888584, 'lng': 151.1873473}, 'SYSU-CHINA': {'lat': 23.0965384, 'lng': 113.298883}, 'SYSU-MED': {'lat': 23.0965384, 'lng': 113.298883}, 'SYSU-MEDICINE': {'lat': 23.0965384, 'lng': 113.298883}, 'SYSU-Software': {'lat': 23.0965384, 'lng': 113.298883}, 'SZU-China': {'lat': 22.53306, 'lng': 113.932813}, 'TAS_Taipei': {'lat': 25.1169089, 'lng': 121.5291433}, 'TCU_Taiwan': {'lat': 23.9928054, 'lng': 121.5912448}, 'Tec-Chihuahua': {'lat': 28.691488, 'lng': -106.0851138}, 'TEC-Costa_Rica': {'lat': 9.748916999999999, 'lng': -83.753428}, 'Tec-Monterrey': {'lat': 25.6515649, 'lng': -100.28954}, 'Technion_Israel': {'lat': 32.77769300000001, 'lng': 35.0271339}, 'TEC_GenetiX_CCM': {'lat': 19.2845446, 'lng': -99.1373308}, 'Tel-Hai': {'lat': 33.235864, 'lng': 35.578207}, 'Tianjin': {'lat': 39.0069377, 'lng': 117.3487234}, 'TJUSLS_China': {'lat': 39.113684, 'lng': 117.169659}, 'TMMU_China': {'lat': 29.5375783, 'lng': 106.4483855}, 'Tokyo_Tech': {'lat': 35.6051229, 'lng': 139.6835302}, 'Tonbridge': {'lat': 51.1966415, 'lng': 0.2752893}, 'Tongji_Shanghai': {'lat': 31.281675, 'lng': 121.504653}, 'Toronto': {'lat': 43.7077119, 'lng': -79.3949416}, 'Toulouse_France': {'lat': 43.57126299999999, 'lng': 1.4658639}, 'TP_CC_SanDiego': {'lat': 32.9572601, 'lng': -117.199192}, 'TrinityCollegeDublin': {'lat': 53.3437935, 'lng': -6.254571599999999}, 'Tsinghua': {'lat': 39.9996674, 'lng': 116.3264439}, 'Tsinghua-A': {'lat': 39.9996674, 'lng': 116.3264439}, 'TU-Eindhoven': {'lat': 51.4470477, 'lng': 5.4946871}, 'Tuebingen': {'lat': 48.5309963, 'lng': 9.038115099999999}, 'Tufts': {'lat': 42.403673, 'lng': -71.1133468}, 'TU_Darmstadt': {'lat': 49.86842499999999, 'lng': 8.6814868}, 'TU_Delft': {'lat': 52.0009167, 'lng': 4.3756415}, 'UAM_Poznan': {'lat': 52.4671046, 'lng': 16.9249124}, 'UBonn_HBRS': {'lat': 50.7336439, 'lng': 7.071955200000001}, 'UCAS': {'lat': 39.9081199, 'lng': 116.252562}, 'UCC_Ireland': {'lat': 51.89211239999999, 'lng': -8.493267099999999}, 'UChicago': {'lat': 41.7916469, 'lng': -87.6034081}, 'UCL': {'lat': 51.52446880000001, 'lng': -0.1327183}, 'UCLA': {'lat': 34.0680878, 'lng': -118.4416559}, 'UCLouvain': {'lat': 50.66968749999999, 'lng': 4.6155909}, 'UConn': {'lat': 41.8077414, 'lng': -72.2539805}, 'UCSC': {'lat': 36.9741171, 'lng': -122.0307963}, 'UCSD_Auditory': {'lat': 32.8328112, 'lng': -117.2712717}, 'UC_Davis': {'lat': 38.5352381, 'lng': -121.765101}, 'UC_San_Diego': {'lat': 32.8800604, 'lng': -117.2340135}, 'UESTC-China': {'lat': 30.670558, 'lng': 104.1077339}, 'UESTC-software': {'lat': 30.670558, 'lng': 104.1077339}, 'UFAM-UEA_Brazil': {'lat': -3.0981791, 'lng': -59.9842893}, 'UGA-Georgia': {'lat': 33.9482351, 'lng': -83.37288079999999}, 'UGent_Belgium': {'lat': 51.0527795, 'lng': 3.7089586}, 'UI-Indonesia': {'lat': -6.1984015, 'lng': 106.8508456}, 'UiOslo_Norway': {'lat': 59.9399586, 'lng': 10.7217496}, 'UIUC_Illinois': {'lat': 40.104993, 'lng': -88.224893}, 'ULV-LC-CV': {'lat': 34.1008542, 'lng': -117.7732346}, 'UMaryland': {'lat': 38.9893401, 'lng': -76.9400829}, 'UMass-Dartmouth': {'lat': 41.6241366, 'lng': -71.0059875}, 'UNC-Chapel_Hill': {'lat': 35.9027283, 'lng': -79.0547366}, 'UNebraska-Lincoln': {'lat': 40.8201966, 'lng': -96.70047629999999}, 'UNH_Durham': {'lat': 43.138948, 'lng': -70.9370252}, 'UNIK_Copenhagen': {'lat': 55.68323419999999, 'lng': 12.5442409}, 'UNSW_Australia': {'lat': -33.917347, 'lng': 151.2312675}, 'UoA_NewZealand': {'lat': -36.8508114, 'lng': 174.7712272}, 'UofC_Calgary': {'lat': 51.0662404, 'lng': -114.1347299}, 'UPF-CRG_Barcelona': {'lat': 41.3789689, 'lng': 2.179794100000001}, 'UPIBI-IPN': {'lat': 19.4952138, 'lng': -99.11376609999999}, 'UPO-Sevilla': {'lat': 37.35912039999999, 'lng': -5.938296999999999}, 'Uppsala': {'lat': 59.85856380000001, 'lng': 17.6389267}, 'USNA_Midshipmen': {'lat': 38.8233858, 'lng': -77.0180331}, 'USP-EEL-Brazil': {'lat': -22.6969489, 'lng': -45.1192088}, 'USP_UNIFESP': {'lat': -23.5613991, 'lng': -46.7307891}, 'USTC': {'lat': 31.8410126, 'lng': 117.240005}, 'USTC-Software': {'lat': 31.847443, 'lng': 117.295572}, 'UST_Beijing': {'lat': 39.9891783, 'lng': 116.3396433}, 'UT-Knoxville': {'lat': 35.9577637, 'lng': -83.92400789999999}, 'UT-Tokyo': {'lat': 35.659854, 'lng': 139.68465}, 'Valencia_UPV': {'lat': 39.4704139, 'lng': -0.3418927}, 'Vanderbilt': {'lat': 36.1445701, 'lng': -86.8003339}, 'Vanderbilt_Software': {'lat': 36.1445701, 'lng': -86.8003339}, 'Vilnius-Lithuania': {'lat': 54.721729, 'lng': 25.3314057}, 'Virginia': {'lat': 38.0341859, 'lng': -78.5128051}, 'Wageningen_UR': {'lat': 51.9690358, 'lng': 5.6806526}, 'Warwick': {'lat': 52.38155099999999, 'lng': -1.5616906}, 'Washington': {'lat': 47.655826, 'lng': -122.3148976}, 'WashU_StLouis': {'lat': 38.6487895, 'lng': -90.31079620000001}, 'Waterloo': {'lat': 43.4722854, 'lng': -80.5448576}, 'Westlake': {'lat': 34.1606078, 'lng': -118.8164784}, 'Westminster_UoW': {'lat': 51.5207612, 'lng': -0.1400551}, 'William_and_Mary': {'lat': 37.2695679, 'lng': -76.71444180000002}, 'WLC-Milwaukee': {'lat': 43.0379137, 'lng': -88.0232388}, 'Wound-Aid-West-Point': {'lat': 43.0379137, 'lng': -88.0232388}, 'WPI_Worcester': {'lat': 42.274229, 'lng': -71.8106028}, 'XJTLU-CHINA': {'lat': 31.27468, 'lng': 120.738192}, 'XMU-China': {'lat': 24.4373484, 'lng': 118.097855}, 'Yale': {'lat': 41.3163244, 'lng': -72.92234309999999}, 'YEG-enetics': {'lat': 53.5267284, 'lng': -113.526999}, 'ZJU-China': {'lat': 30.30868439999999, 'lng': 120.0864995}, 'CGU_Taiwan': {'lat': 25.032678, 'lng': 121.389945}, 'Chalmers_Gothenburg': {'lat': 57.70887, 'lng': 11.97456}}

bio_words = ["genetic circuits","extraterrestial","moon","pathogen","parasite","fungus/fungal","bioremediation","radiation","biosensor","cancer","Alzheimer's","Parkinson's","biosynthesis","biodegradation","recycling","bioenergy","dyes","textiles","venom","antivenom","insecticides","CRISPR","virus","HIV","ALS","penicillin","biochip","celiac","robocrop","contraceptive","metabolic pathways","oil","yeast","mining","fish","oscillations","circadian rythms","gene therapy","quorum sensing","antibodies","amyloids","biofilm","uric acid/urine","coculture","optogenetics","biomaterial","corrosion","biocatalysis","bacteriophage","bioplastic","keratin","corn","nanotechnology","pollutants","therapeutic","tobacco","cat?","rat?","bioweapon","recombinant","vaccine","drug delivery","malaria","cholera","biomanufacturing","biotagging","immunotherapy","endophytes","Huntington's","Nanomaterial","bioethanol","cyanobacteria","chitin","enzymolysis","antimicrobial resistance","antibiotic resistance","telomerase","histidine","dioxin","biostimulants","bacteriocin","microbiota","progesterone","emerald ash borer","protein scaffold","IBD","nodulation","nicotine","carcinogenic"]
bio_words = set([x.lower() for x in bio_words])
# with open("iGEM_2016_Teams.geojson") as geo_json:
#   geo_data = json.loads(geo_json.read())
#   for feature in geo_data["features"][180:]:
#       print("doing:", feature["properties"]["Name"], feature["properties"]["description"])
#       if feature["properties"]["description"] != None:
#           geolocator = GoogleV3(api_key="INSERT")
#           location = geolocator.geocode(feature["properties"]["description"], language='en')
#       if location != None:
#           geo_from_json[feature["properties"]["Name"]] = {"lat": location.latitude, "lng": location.longitude}
#       # time.sleep(0.1)
#       print(geo_from_json)




translator = str.maketrans('', '', string.punctuation)
visited = set()
all_teams = set()

def tag_visible(element):
    if element.parent.name in ['style', 'script', 'head', 'title', 'meta', '[document]']:
        return False
    if isinstance(element, Comment):
        return False
    return True


def text_from_html(body):
    soup = BeautifulSoup(body, 'html.parser')
    texts = soup.findAll(text=True)
    visible_texts = filter(tag_visible, texts)  
    return u" ".join(t.strip() for t in visible_texts)

def get_soup(team_page_link, team_name, original_team_name):
    global visited, all_teams, session    
    time.sleep(1) 	
    totalCounter = Counter()
    collabs = set()
    # print(visited)
    if team_page_link is not None and "igem.org/Team" in team_page_link and team_page_link not in visited:
        # print(team_page_link)
        visited.add(team_page_link)
        # print(team_page_link)
        raw_text = session.get(team_page_link).text
        team_page_soup = BeautifulSoup(raw_text, "html.parser")
        visible_text =  text_from_html(raw_text)
        split_text = visible_text.split()
        if "collaborations" in team_page_link.lower():
            for k in all_teams:
                for index_j, j in enumerate(split_text):                    
                    underscore_team = k.replace(" ", "_")
                    # Avoid attempting to parse Unicode-specific characters
                    try:
                        test_unicode = str(j.encode("ascii"))
                        if index_j < len(split_text)-1:
                            test_unicode2 = str((j+split_text[index_j+1]).encode("ascii"))
                    except UnicodeEncodeError:
                        continue
                    # Uses Levenshtein distance for fuzzy string matching
                    if ((fuzz.ratio(k.lower(), j.lower()) >= 95
                        or fuzz.WRatio(k.lower(), j.lower()) >= 95)
                        or 
                        (fuzz.ratio(underscore_team.lower(), j.lower()) >= 95
                        or fuzz.WRatio(underscore_team.lower(), j.lower()) >= 95)
                        or (index_j < len(split_text)-1 and 
                            (fuzz.ratio((j+split_text[index_j+1]).lower(), k.lower()) >= 95
                            or fuzz.WRatio((j+split_text[index_j+1]).lower(), k.lower()) >= 95))):
                        print("HIT" * 100)
                        print(k, j, team_page_link)
                        if k != original_team_name:
                            collabs.add(k)
        # no_punctuation = visible_text.translate(translator)
        nouns =  [x[0].lower() for x in nltk.pos_tag(nltk.word_tokenize(visible_text)) if x[1][0] == "N" and x[0].lower() in bio_words]
        totalCounter += Counter(nouns)
        page_links = team_page_soup.findAll('a')
        for i in page_links:
            link = i.get("href")
            if link != None and team_name in link and link[0:4] == "http":
                tc, collabsNew = get_soup(link, team_name, original_team_name)
                totalCounter += tc
                collabs  = collabs.union(collabsNew)
    return totalCounter, collabs

# To populate all teams
def populate_all_teams2018():
	global all_teams
	for year in range(2018, 2019):
	    url = "https://igem.org/Team_Wikis?year=" + str(year)
	    response = requests.get(url)
	    soup = BeautifulSoup(response.text, "html.parser")
	    cur_year_links = soup.findAll('a')
	    
	    for i in cur_year_links:        
	        print("NEXT TEAM")
	        print("-"*50)
	        team_page_link = i.get("href")
	        if team_page_link != None and len(team_page_link) > 26:
	            print(team_page_link[26:])
	            # print(team_page_link)
	            # if team_page_link != 'http://2015.igem.org/Team:CityU HK':
	            #   continue

	            team_name = team_page_link[26:]
	            all_teams.add(team_name)

	all_teams = set(geo_from_json.keys())

def populate_geo_teams():
	global all_teams, geo_teams
	geo_teams = {}
	for team in all_teams:
	  location = geolocator.geocode(team, language='en')
	  print("TEAM:", team)
	  print("-"*50)
	  if location != None:
	      # print (json.dumps(location.raw, indent=4))
	      # print (location.address)
	      print(location.latitude, location.longitude)
	      geo_teams[team] = {"lat": location.latitude, "lng": location.longitude}
	  else:
	      print ("No location!" , location)
	      geo_teams[team] = None
	  # print(geo_teams)

# geo_teams = {'Bielefeld-CeBiTec': {'lat': 52.039406, 'lng': 8.491052}, 'Cornell': {'lat': 42.4534492, 'lng': -76.4735027}, 'Tsinghua-A': {'lat': 39.9996674, 'lng': 116.3264439}, 'TUDelft': {'lat': 52.0021256, 'lng': 4.3732982}, 'UI Indonesia': {'lat': -6.3627638, 'lng': 106.8270482}, 'GDSYZX': {'lat': 23.126054, 'lng': 113.277396}, 'SCAU-China': {'lat': 23.1568182, 'lng': 113.3536811}, 'FSU': {'lat': 30.4418778, 'lng': -84.2984889}, 'NUS Singapore-A': {'lat': 1.2966426, 'lng': 103.7763939}, 'Worldshaper-Wuhan': {'lat': 30.592849, 'lng': 114.305539}, 'Leiden': {'lat': 52.1601144, 'lng': 4.4970097}, 'IIT Kanpur': {'lat': 26.5123388, 'lng': 80.2329}, 'Auckland MOD': {'lat': -36.8484597, 'lng': 174.7633315}, 'HSHL': {'lat': 39.2870287, 'lng': -76.6240078}, 'Lethbridge': {'lat': 49.6955856, 'lng': -112.8451364}, 'NU Kazakhstan': {'lat': 51.0905303, 'lng': 71.3981646}, 'Saint Joseph': {'lat': 39.7674578, 'lng': -94.84668099999999}, 'Bordeaux': {'lat': 44.837789, 'lng': -0.57918}, 'CDHSU-CHINA': None, 'H14Z1 Hangzhou': {'lat': 30.274084, 'lng': 120.15507}, 'SDU-CHINA': {'lat': 36.64893, 'lng': 117.029014}, 'XJTLU-CHINA': {'lat': 31.274822, 'lng': 120.738094}, 'SMMU-China': {'lat': 31.30603049999999, 'lng': 121.5292392}, 'DTU-Denmark': {'lat': 55.7855742, 'lng': 12.521381}, 'Duesseldorf': {'lat': 51.2277411, 'lng': 6.7734556}, 'Lund': {'lat': 55.7046601, 'lng': 13.1910073}, 'Munich': {'lat': 48.1351253, 'lng': 11.5819805}, 'Goettingen': {'lat': 51.54128040000001, 'lng': 9.915803499999999}, 'HUBU-Wuhan': {'lat': 30.5470836, 'lng': 114.2980092}, 'Linkoping Sweden': {'lat': 58.41080700000001, 'lng': 15.6213728}, 'UCSC': {'lat': 36.9880503, 'lng': -122.0582093}, 'SDSZ China': {'lat': 39.911251, 'lng': 116.368345}, 'HFLS ZhejiangUnited': {'lat': 40.7509446, 'lng': -73.97386879999999}, 'GZHS-United': None, 'NTNU Trondheim': {'lat': 63.4288793, 'lng': 10.3904238}, 'UIOWA': {'lat': 41.6626963, 'lng': -91.5548998}, 'SJTU-software': {'lat': 31.0252201, 'lng': 121.4337784}, 'BNDS CHINA': {'lat': 39.902615, 'lng': 116.255987}, 'RMHS Maryland': {'lat': 39.0793201, 'lng': -77.1466232}, 'MichiganState': {'lat': 42.701848, 'lng': -84.4821719}, 'JMU Wuerzburg': {'lat': 49.7881814, 'lng': 9.93526}, 'SYSU-CHINA': {'lat': 23.0965384, 'lng': 113.298883}, 'Waterloo': {'lat': 42.492786, 'lng': -92.34257749999999}, 'SHPH-Shanghai': {'lat': 31.230416, 'lng': 121.473701}, 'DLUT China': {'lat': 38.880381, 'lng': 121.529021}, 'SZU-China': {'lat': 22.53306, 'lng': 113.932813}, 'Vilnius-Lithuania': {'lat': 54.6871555, 'lng': 25.2796514}, 'Tianjin': {'lat': 39.3433574, 'lng': 117.3616476}, 'TPHS San Diego': {'lat': 32.9574372, 'lng': -117.2261884}, 'Tuebingen': {'lat': 48.5216364, 'lng': 9.0576448}, 'Pittsburgh': {'lat': 40.44062479999999, 'lng': -79.9958864}, 'BioMarvel': None, 'CIEI-BJ': {'lat': -23.027504, 'lng': -43.52018}, 'Hong Kong HKU': {'lat': 22.2829989, 'lng': 114.1370848}, 'ACIBADEM ISTANBUL': {'lat': 41.0417388, 'lng': 28.9827314}, 'Austin UTexas': {'lat': 30.2849185, 'lng': -97.7340567}, 'Harvard': {'lat': 42.3770029, 'lng': -71.11666009999999}, 'USAFA': {'lat': 38.9983094, 'lng': -104.8613176}, 'LZU-CHINA': {'lat': 36.0477699, 'lng': 103.8585624}, 'Pittsburgh CSL': {'lat': 40.438209, 'lng': -79.94851799999999}, 'Rotterdam HR': {'lat': 51.9134313, 'lng': 4.4684668}, 'Hamline Genetics': {'lat': 44.9650603, 'lng': -93.1645547}, 'RHIT': {'lat': 39.4816947, 'lng': -87.3252467}, 'IISc-Bangalore': {'lat': 13.0218597, 'lng': 77.5671423}, 'AFCM-Egypt': {'lat': 30.0845176, 'lng': 31.3041407}, 'IIT-Madras': {'lat': 12.9914929, 'lng': 80.2336907}, 'Melbourne': {'lat': -37.8136276, 'lng': 144.9630576}, 'SMS Shenzhen': {'lat': 22.551389, 'lng': 114.121602}, 'JNFLS': {'lat': 36.654028, 'lng': 117.004155}, 'Sorbonne U Paris': {'lat': 48.8484556, 'lng': 2.3432774}, 'Claremont': {'lat': 34.0966764, 'lng': -117.7197785}, 'ETH Zurich': {'lat': 47.376313, 'lng': 8.547669899999999}, 'CCA-San Diego': {'lat': 32.9590757, 'lng': -117.1894333}, 'Minnesota': {'lat': 46.729553, 'lng': -94.6858998}, 'Tokyo Tech': {'lat': 35.6051229, 'lng': 139.6835302}, 'UT-Knoxville': {'lat': 35.9544013, 'lng': -83.92945639999999}, 'OUC-China': {'lat': 36.061255, 'lng': 120.335301}, 'Missouri Rolla': {'lat': 37.948544, 'lng': -91.7715303}, 'CO Mines': {'lat': 39.7510475, 'lng': -105.2225708}, 'Fudan-CHINA': {'lat': 31.2974197, 'lng': 121.5036178}, 'BioIQS-Barcelona': {'lat': 41.4031242, 'lng': 2.1196377}, 'BrockU': {'lat': 43.1175731, 'lng': -79.2476925}, 'UiOslo Norway': {'lat': 59.9138688, 'lng': 10.7522454}, 'TAS Taipei': {'lat': 25.1169089, 'lng': 121.5291433}, 'CMUQ': {'lat': 25.316358, 'lng': 51.438599}, 'ZJU-China': {'lat': 30.30868439999999, 'lng': 120.0864995}, 'BUCT-China': {'lat': 39.970954, 'lng': 116.421053}, 'Westminster UK': {'lat': 51.5001754, 'lng': -0.1332326}, 'Grenoble-Alpes': {'lat': 45.188529, 'lng': 5.724524}, 'Hong Kong-CUHK': {'lat': 22.4195827, 'lng': 114.2067604}, 'NTHU Formosa': {'lat': 24.7947253, 'lng': 120.9932316}, 'BJRS China': None, 'Stuttgart': {'lat': 48.7758459, 'lng': 9.1829321}, 'UCLouvain': {'lat': 50.66968749999999, 'lng': 4.6155909}, 'SHSU China': {'lat': 30.7129974, 'lng': -95.5472905}, 'Northwestern': {'lat': 42.0564594, 'lng': -87.67526699999999}, 'ColegioFDR Peru': {'lat': -12.0774235, 'lng': -76.97166680000001}, 'ASTWS-China': None, 'UST Beijing': {'lat': 39.90419989999999, 'lng': 116.4073963}, 'UCopenhagen': {'lat': 55.6802303, 'lng': 12.5724096}, 'MIT': {'lat': 42.360091, 'lng': -71.09416}, 'Gaston Day School': {'lat': 35.201648, 'lng': -81.14122499999999}, 'BFSUICC-China': {'lat': 42.81544, 'lng': -82.515502}, 'Hamburg': {'lat': 53.5510846, 'lng': 9.9936819}, 'Virginia': {'lat': 37.4315734, 'lng': -78.6568942}, 'Emory': {'lat': 33.7971368, 'lng': -84.32224}, 'NEFU China': {'lat': 45.7240008, 'lng': 126.6403002}, 'Lethbridge HS': {'lat': 49.6736681, 'lng': -112.9101091}, 'Valencia UPV': {'lat': 39.4807985, 'lng': -0.3406299}, 'NYMU-Taipei': {'lat': 25.123002, 'lng': 121.513702}, 'HebrewU': {'lat': 31.7945578, 'lng': 35.2414009}, 'UNSW Australia': {'lat': -33.917347, 'lng': 151.2312675}, 'Uppsala': {'lat': 59.85856380000001, 'lng': 17.6389267}, 'Nanjing-China': {'lat': 32.060255, 'lng': 118.796877}, 'Mingdao': None, 'BGU Israel': {'lat': 31.262218, 'lng': 34.801461}, 'Newcastle': {'lat': 54.978252, 'lng': -1.61778}, 'UC Davis': {'lat': 38.5382322, 'lng': -121.7617125}, 'SBS SH 112144': None, 'Gifu': {'lat': 35.42342259999999, 'lng': 136.7606217}, 'Nanjing NFLS': {'lat': 32.056151, 'lng': 118.801451}, 'ZJUT-China': {'lat': 30.225796, 'lng': 120.039175}, 'UChile Biotec': None, 'NJU-China': {'lat': 32.0568391, 'lng': 118.7789602}, 'SIAT-SCIE': None, 'Jiangnan': {'lat': 40.7083773, 'lng': -74.01404660000001}, 'NTU-Singapore': {'lat': 1.3483099, 'lng': 103.6831347}, 'Tec-Chihuahua': {'lat': 28.6643762, 'lng': -106.0905708}, 'Purdue': {'lat': 40.4237054, 'lng': -86.92119459999999}, 'ColumbiaNYC': {'lat': 40.8075355, 'lng': -73.9625727}, 'SHSID China': {'lat': 31.1411957, 'lng': 121.4369131}, 'McGill': {'lat': 45.50478469999999, 'lng': -73.5771511}, 'Toronto': {'lat': 43.653226, 'lng': -79.3831843}, 'UFlorida': {'lat': 29.6436325, 'lng': -82.3549302}, 'WPI Worcester': {'lat': 42.27463669999999, 'lng': -71.8063379}, 'IISER-Mohali': {'lat': 30.6649526, 'lng': 76.73004209999999}, 'Tec-Monterrey': {'lat': 28.67405, 'lng': -106.077612}, 'IIT Delhi': {'lat': 28.5449756, 'lng': 77.19262839999999}, 'KCL UK': {'lat': 51.5114864, 'lng': -0.115997}, 'BCU': {'lat': 42.2331458, 'lng': -87.9445206}, 'Hong Kong JSS': None, 'UChicago': {'lat': 41.7886079, 'lng': -87.5987133}, 'NUS Singapore-Sci': {'lat': 1.2966426, 'lng': 103.7763939}, 'XJTU-China': {'lat': 34.250803, 'lng': 108.983693}, 'SJTU-BioX-Shanghai': {'lat': 31.0252201, 'lng': 121.4337784}, 'Chalmers-Gothenburg': {'lat': 57.6897063, 'lng': 11.9741654}, 'Oxford': {'lat': 51.7520209, 'lng': -1.2577263}, 'HK HCY LFC': None, 'NCHU Taichung': {'lat': 24.123552, 'lng': 120.675326}, 'Tongji-Software': {'lat': 31.2627211, 'lng': 121.4598975}, 'Exeter': {'lat': 36.2960613, 'lng': -119.1420517}, 'Baltimore BioCrew': {'lat': 39.2941418, 'lng': -76.56225429999999}, 'Navarra BG': None, 'NEU China B': {'lat': 42.3398067, 'lng': -71.0891717}, 'SFLS Shenzhen': {'lat': 22.547956, 'lng': 114.093636}, 'USMA-West Point': {'lat': 41.3918372, 'lng': -73.9625033}, 'Dalhousie Halifax NS': {'lat': 44.63658119999999, 'lng': -63.59165549999999}, 'Peking': {'lat': 39.90419989999999, 'lng': 116.4073963}, 'CSU Fort Collins': {'lat': 40.573436, 'lng': -105.0865473}, 'Botchan Lab Tokyo': {'lat': 35.6803997, 'lng': 139.7690174}, 'Lambert GA': {'lat': 34.1062076, 'lng': -84.1389311}, 'Makerere University': {'lat': 0.3292819, 'lng': 32.5710773}, 'SSHS-Shenzhen': {'lat': 22.543096, 'lng': 114.057865}, 'BIT-China': {'lat': 39.9603704, 'lng': 116.3123886}, 'FAU Erlangen': {'lat': 49.5978804, 'lng': 11.0045507}, 'GreatBay China': {'lat': 43.0721378, 'lng': -70.79865989999999}, 'Tartu TUIT': {'lat': 58.37798299999999, 'lng': 26.7290383}, 'Vilnius-Lithuania-OG': {'lat': 54.6871555, 'lng': 25.2796514}, 'Tacoma RAINmakers': {'lat': 47.2528768, 'lng': -122.4442906}, 'East Chapel Hill': {'lat': 35.9131996, 'lng': -79.0558445}, 'Athens': {'lat': 37.9838096, 'lng': 23.7275388}, 'Jilin China': {'lat': 43.837883, 'lng': 126.549572}, 'BNU-China': {'lat': 39.9619537, 'lng': 116.3662615}, 'HUST-China': {'lat': 30.5130043, 'lng': 114.4202756}, 'NKU CHINA': {'lat': 39.0319664, 'lng': -84.4645836}, 'NYU Abu Dhabi': {'lat': 24.5238948, 'lng': 54.4345558}, 'WHU-China': {'lat': 30.5360485, 'lng': 114.3643219}, 'NEU China A': None, 'EPFL': {'lat': 46.5190557, 'lng': 6.5667576}, 'HZAU-China': {'lat': 30.475126, 'lng': 114.353035}, 'GO Paris-Saclay': None, 'BostonU': {'lat': 42.3600825, 'lng': -71.0588801}, 'WashU StLouis': {'lat': 38.6487895, 'lng': -90.31079620000001}, 'Rice': {'lat': 36.1007073, 'lng': -95.9037475}, 'William and Mary': {'lat': 37.271674, 'lng': -76.71337799999999}, 'TecMonterrey GDL': {'lat': 20.7353206, 'lng': -103.4555127}, 'TecCEM': None, 'Toulouse-INSA-UPS': {'lat': 43.5696438, 'lng': 1.4677288}, 'Jiangnan China': {'lat': 22.781631, 'lng': 108.273158}, 'FJNU-China': {'lat': 26.0252776, 'lng': 119.2117845}, 'HKJS S': {'lat': 22.261919, 'lng': 114.190797}, 'Edinburgh UG': {'lat': 55.9445158, 'lng': -3.1892413}, 'Thessaloniki': {'lat': 40.6400629, 'lng': 22.9444191}, 'HBUT-China': {'lat': 30.481761, 'lng': 114.31096}, 'NCTU Formosa': {'lat': 24.7859852, 'lng': 120.9999097}, 'Worldshaper-XSHS': None, 'SCUT ChinaB': {'lat': 23.151326, 'lng': 113.344683}, 'UMass Dartmouth': {'lat': 41.6282132, 'lng': -71.00415}, 'BGIC-Global': None, 'TUST China': {'lat': 39.083961, 'lng': 117.708631}, 'CPU CHINA': {'lat': 32.072145, 'lng': 118.77875}, 'British Columbia': {'lat': 53.7266683, 'lng': -127.6476205}, 'SCU-China': {'lat': 30.26380319999999, 'lng': 102.8054753}, 'Manchester': {'lat': 53.4807593, 'lng': -2.2426305}, 'USP-Brazil': {'lat': -23.5613991, 'lng': -46.7307891}, 'Duke': {'lat': 36.0014258, 'lng': -78.9382286}, 'CSU CHINA': {'lat': 28.16437, 'lng': 112.93251}, 'Aachen': {'lat': 50.7753455, 'lng': 6.083886800000001}, 'ULaVerne Collab': None, 'Stockholm': {'lat': 59.32932349999999, 'lng': 18.0685808}, 'USP-EEL-Brazil': {'lat': -22.6982137, 'lng': -45.1186439}, 'Bio Without Borders': {'lat': 40.6877335, 'lng': -73.9797385}, 'Hong Kong HKUST': {'lat': 22.3363998, 'lng': 114.2654655}, 'Stanford': {'lat': 37.4274745, 'lng': -122.169719}, 'New York City': {'lat': 40.7127753, 'lng': -74.0059728}, 'NTHU Taiwan': {'lat': 24.7947253, 'lng': 120.9932316}, 'UGA': {'lat': 33.9480053, 'lng': -83.3773221}, 'Stanford-Brown-RISD': {'lat': 41.8258538, 'lng': -71.4077368}, 'NCKU Tainan': {'lat': 22.9988416, 'lng': 120.2195148}, 'Bilkent-UNAMBG': {'lat': 39.86769899999999, 'lng': 32.747576}, 'UConn': {'lat': 41.8077414, 'lng': -72.2539805}, 'METU HS Ankara': {'lat': 39.8910203, 'lng': 32.7780027}, 'Paris Bettencourt': None, 'Lubbock TTU': {'lat': 33.5842591, 'lng': -101.8782822}, 'SCUT-ChinaA': {'lat': 23.151326, 'lng': 113.344683}, 'LACAS BioBots': {'lat': 39.976112, 'lng': -75.040717}, 'AHUT China': {'lat': 31.692956, 'lng': 118.510711}, 'UESTC-China': {'lat': 30.6624863, 'lng': 104.1021662}, 'CCU Taiwan': {'lat': 23.5633761, 'lng': 120.4728831}, 'USTC-Software': None, 'Hawaii': {'lat': 19.8967662, 'lng': -155.5827818}, 'IISER-Bhopal-India': {'lat': 23.2883503, 'lng': 77.2757147}, 'ECUST': {'lat': 31.140897, 'lng': 121.425248}, 'Bulgaria': {'lat': 42.733883, 'lng': 25.48583}, 'Utrecht': {'lat': 52.09073739999999, 'lng': 5.1214201}, 'Austin LASA': {'lat': 30.313549, 'lng': -97.656741}, 'DNHS SanDiego': {'lat': 33.0144484, 'lng': -117.1214139}, 'ULaval': {'lat': 46.78174629999999, 'lng': -71.2747424}, 'REC-CHENNAI': {'lat': 13.009575, 'lng': 80.004243}, 'SUSTech Shenzhen': {'lat': 22.593969, 'lng': 113.99894}, 'Nottingham': {'lat': 52.95478319999999, 'lng': -1.1581086}, 'USTC': {'lat': 39.9812793, 'lng': -75.7377941}, 'Calgary': {'lat': 51.04473309999999, 'lng': -114.0718831}, 'Georgia State': {'lat': 33.753068, 'lng': -84.38528190000001}, 'VIT Vellore': {'lat': 12.972067, 'lng': 79.1595619}, 'ASIJ Tokyo': {'lat': 35.6815422, 'lng': 139.5215285}, 'UMaryland': {'lat': 39.2892017, 'lng': -76.6257057}, 'Cardiff Wales': {'lat': 51.48158100000001, 'lng': -3.17909}, 'Stony Brook': {'lat': 40.9256538, 'lng': -73.1409429}, 'KAIT JAPAN': {'lat': 35.4865554, 'lng': 139.3432554}, 'SSTi-SZGD': None, 'Fudan': {'lat': 31.2974197, 'lng': 121.5036178}, 'Ruia-Mumbai': {'lat': 19.023554, 'lng': 72.85005679999999}, 'RDFZ-China': {'lat': 39.973592, 'lng': 116.312477}, 'ICT-Mumbai': {'lat': 19.0239192, 'lng': 72.8575207}, 'NAWI Graz': None, 'Pasteur Paris': {'lat': 48.8429006, 'lng': 2.3126028}, 'IISER-Kolkata': {'lat': 22.9638419, 'lng': 88.5245023}, 'Rheda Bielefeld': {'lat': 51.8458575, 'lng': 8.299742499999999}, 'NWU-China': {'lat': 34.14552, 'lng': 108.875136}, 'Evry Paris-Saclay': {'lat': 48.6241125, 'lng': 2.4271811}, 'SHSBNU China': {'lat': 39.9534773, 'lng': -75.1565547}, 'BOKU-Vienna': {'lat': 48.2365448, 'lng': 16.337579}, 'HAFS': {'lat': 42.5624423, 'lng': -88.3309336}, 'NUDT CHINA': None, 'SYSU-Software': {'lat': 33.662781, 'lng': -117.750974}, 'Marburg': {'lat': 50.8021728, 'lng': 8.7667933}, 'UC San Diego': {'lat': 32.8800604, 'lng': -117.2340135}, 'SKLMT-China': None, 'Montpellier': {'lat': 43.610769, 'lng': 3.876716}, 'Ecuador': {'lat': -1.831239, 'lng': -78.18340599999999}, 'UofGuelph': {'lat': 43.5327217, 'lng': -80.22618039999999}, 'KUAS Korea': None, 'Madrid-OLM': {'lat': 40.4711643, 'lng': -3.685803}, 'ShanghaiTech': {'lat': 31.1763741, 'lng': 121.5924518}, 'Yale': {'lat': 41.3163244, 'lng': -72.92234309999999}, 'UESTC-Software': {'lat': 30.6624863, 'lng': 104.1021662}, 'McMaster': {'lat': 43.260879, 'lng': -79.9192254}, 'NPU-China': None, 'UPF CRG Barcelona': {'lat': 41.3853788, 'lng': 2.1940517}, 'BIT': {'lat': 36.4008825, 'lng': -95.7841234}, 'Aix-Marseille': {'lat': 43.29362099999999, 'lng': 5.358066}, 'Queens Canada': {'lat': 44.2252795, 'lng': -76.49514119999999}, 'WLC-Milwaukee': {'lat': 43.0367864, 'lng': -88.02269230000002}, 'TJU China': None, 'Tsinghua': {'lat': 39.9996674, 'lng': 116.3264439}, 'Kyoto': {'lat': 35.011564, 'lng': 135.7681489}, 'SUIS Shanghai': {'lat': 31.189341, 'lng': 121.40646}, 'UNebraska-Lincoln': {'lat': 40.8201966, 'lng': -96.70047629999999}, 'DLUT China B': {'lat': 38.880381, 'lng': 121.529021}, 'OLS Canmore Canada': {'lat': 51.0494006, 'lng': -115.3184598}, 'UCL': {'lat': 51.52455920000001, 'lng': -0.1340401}, 'Warwick': {'lat': 41.2638494, 'lng': -74.3822058}, 'BostonU HW': {'lat': 42.3436095, 'lng': -71.0651063}, 'Unesp Brazil': {'lat': -21.7936447, 'lng': -48.1814324}, 'NDC-HighRiverAB': {'lat': 50.5916726, 'lng': -113.8947432}, 'Imperial College': {'lat': 51.49879970000001, 'lng': -0.1748772}, 'Tufts': {'lat': 42.4074843, 'lng': -71.1190232}, 'TU-Eindhoven': {'lat': 51.44860980000001, 'lng': 5.4907148}, 'Groningen': {'lat': 53.2193835, 'lng': 6.5665017}, 'TU Darmstadt': {'lat': 49.8748277, 'lng': 8.6563281}, 'Macquarie Australia': {'lat': 38.9301179, 'lng': -94.6876484}, 'Tongji China': {'lat': 31.2627211, 'lng': 121.4598975}, 'UCAS-China': {'lat': 40.408141, 'lng': 116.682386}, 'CU-Boulder': {'lat': 40.00758099999999, 'lng': -105.2659417}, 'iTesla-SoundBio': {'lat': 47.663322, 'lng': -122.316022}, 'US AFRL CarrollHS': None, 'Washington': {'lat': 47.7510741, 'lng': -120.7401385}, 'St Andrews': {'lat': 37.224502, 'lng': -95.7015653}, 'XMU-China': {'lat': 24.4373484, 'lng': 118.097855}, 'Aalto-Helsinki': {'lat': 60.2095893, 'lng': 24.9764658}, 'Michigan': {'lat': 44.3148443, 'lng': -85.60236429999999}, 'UAlberta': {'lat': 53.5232189, 'lng': -113.5263186}, 'CUNY Kingsborough': {'lat': 40.5786362, 'lng': -73.9345287}, 'UIUC Illinois': {'lat': 40.1019523, 'lng': -88.2271615}, 'NAU-CHINA': {'lat': 32.033399, 'lng': 118.842587}, 'Xidian': {'lat': 34.121605, 'lng': 108.840431}, 'Edinburgh OG': {'lat': 55.9343556, 'lng': -3.2003534}}
# print(len(geo_from_json))
# print(len(geo_teams))
# set1 = set([x[0] for x in geo_from_json.items()])
# set2 = set([x[0] for x in geo_teams.items()])
# print(set1 ^ set2)
# for i in geo_teams:
#   if i not in geo_from_json:
#       print(i, geo_teams[i]) 


# missed = 0
# for i in geo_teams:
#   if geo_teams[i] == None:
#       missed += 1
# print(missed)



def main_scrape():
    global team_collabs, word_freqs, geo_from_json, all_teams, session
    # Main scraping
    for year in range(2016, 2017):
        url = "https://igem.org/Team_Wikis?year=" + str(year)
        response = session.get(url)
        soup = BeautifulSoup(response.text, "html.parser")
        cur_year_links = soup.findAll('a')
        # print(cur_year_links)
        # print(all_teams)
        # START AGAIN AT TEAM 100
        for i in cur_year_links[224:]:
            print("NEXT TEAM")
            print("-"*50)
            team_page_link = i.get("href")
            if team_page_link != None and len(team_page_link) > 21:
                print(team_page_link[21:])
                original_team_name = team_page_link[26:].replace(" ", "_")
                team_name = team_page_link[21:].replace(" ", "_")
                word_freq, collabs = get_soup(team_page_link, team_name, original_team_name)
                print(word_freq.most_common(20))
                print("collabs", collabs)
                print(original_team_name)
                print(original_team_name in geo_from_json)
                if original_team_name in geo_from_json:
                    team_collabs[original_team_name] = list(collabs)
                    word_freqs[original_team_name] = word_freq
                    with open('word_freqs.json', 'w+') as wf:
                        json.dump(word_freqs, wf)
                    with open('team_collabs.json', 'w+') as tc:
                        json.dump(team_collabs, tc)
                    print("WROTE TO FILE"*50)
# main_scrape()
# print(team_collabs)
print("Finished scrape.")


def graph_teams():
	global geo_from_json, team_collabs, word_freqs
	df = pd.DataFrame.from_dict(geo_from_json, orient='index').reset_index()
	print(df)
	print(df.keys())
	fig = go.Figure(data=go.Scattergeo(
	        lon = df['lng'],
	        lat = df['lat'],
	        text = df['index'] + " Keywords:" + df["words"],
	        mode = 'markers',
	        # marker_color = df['cnt'],
	        hoverinfo = "text",
	        ))
	fig.update_layout(
	        title = 'iGEM Team Collaborations'
	        # geo_scope='usa',
	    )

	# team_collabs = []
	for i in range(len(df)):
	    first_team = df['index'][i]
	    if first_team in team_collabs:
	        for k in team_collabs[first_team]:
	            print(first_team, k)
	            fig.add_trace(
	                go.Scattergeo(
	                    # locationmode = 'USA-states',
	                    lon = [geo_from_json[first_team]['lng'], geo_from_json[k]['lng']],
	                    lat = [geo_from_json[first_team]['lat'], geo_from_json[k]['lat']],
	                    mode = 'lines',
	                    line = dict(width = 1,color = 'red'),
	                    opacity =  0.8,
	                    name=first_team+"<>"+k,
	                    hoverinfo="skip"
	                )
	            )
	fig.update_layout(showlegend=False)
	fig.show()

team_collabs = {"Ethiopia1": [], "Pretoria_UP": ["Aix-Marseille", "Evry", "XMU-China", "Groningen", "UPO-Sevilla"], "AHUT_China": ["JSNU-China", "NAU-CHINA", "USTC-Software", "UESTC-software"], "ASIJ_Tokyo": [], "BHU_China": [], "BIT": ["BIT-China", "SDSZ_CHINA", "USTC", "NYMU-Taipei", "SCUT", "Toulouse_France", "XMU-China"], "BIT-China": ["Lanzhou", "CIEI-BJ", "BIT", "Jilin_China"], "BNDS_China": ["UCAS", "SDSZ_CHINA", "CIEI-BJ", "BHU_China"], "BNU-China": ["FAFU-CHINA"], "CGU_Taiwan": ["BIT", "Virginia", "EPFL"], "CIEI-BJ": ["Tsinghua", "BIT-China", "Tsinghua-A"], "CPU_CHINA": [], "FAFU-CHINA": [], "Fudan": [], "GDSYZX-United": ["Rice", "SCAU-China", "SCU-China"], "Gifu": ["UST_Beijing", "Tokyo_Tech", "UT-Tokyo", "Nagahama", "Kyoto"], "HFUT-China": ["OUC-China"], "HokkaidoU_Japan": ["Kyoto", "Gifu", "UT-Tokyo", "Nagahama", "XMU-China"], "Hong_Kong_HKU": [], "Hong_Kong_HKUST": ["Rice", "IIT-Madras", "NTU-Singapore"], "Hong_Kong_UCCKE": ["Evry", "LMU-TUM_Munich"], "HSiTAIWAN": ["NYMU-Taipei", "NTHU_Taiwan"], "HUST-China": ["JSNU-China", "HZAU-China", "NWPU"], "HZAU-China": ["HUST-China", "Northwestern"], "IISc_Bangalore": ["IIT-Madras"], "IIT-Madras": ["IIT_Kharagpur", "IISc_Bangalore", "Peshawar", "Paris_Bettencourt", "SVCE_CHENNAI"], "IIT_Delhi": [], "IIT_Kharagpur": ["IIT-Madras", "XMU-China", "Peshawar"], "India-Thapar-CSED": [], "Jilin_China": ["Tianjin", "BIT-China", "Peking", "HUST-China"], "JNFLS_China": ["Shenzhen_SFLS"], "JSNU-China": ["AHUT_China", "HUST-China", "ShanghaitechChina"], "KAIT_Japan": ["Tokyo_Tech"], "KoreaSonyeodul": ["Korea_U_Seoul"], "Korea_U_Seoul": ["KoreaSonyeodul"], "Kyoto": ["UT-Tokyo", "Nagahama", "Gifu"], "Lanzhou": ["BIT-China"], "LN-Shiyan-China": [], "Macquarie_Australia": ["Paris_Bettencourt", "Melbourne", "Virginia", "NTU-Singapore"], "Melbourne": ["NUS_Singapore", "NTU-Singapore"], "Mingdao": [], "Nagahama": ["BioBricks", "NEFU_China", "Paris_Saclay", "Kyoto", "Virginia", "Gifu", "UI-Indonesia", "UGA-Georgia", "Tokyo_Tech", "UT-Tokyo"], "Nanjing-China": ["NEU-China", "UCAS", "Tianjin"], "Nanjing_NFLS": ["Vanderbilt", "Yale", "CCA_SanDiego"], "NAU-CHINA": ["AHUT_China", "FAFU-CHINA", "NTHU_Taiwan", "NEFU_China", "NKU_China"], "NCKU_Tainan": [], "NCL_India": [], "NCTU_Formosa": ["NCKU_Tainan", "BioBricks", "Sheffield", "NYMU-Taipei", "TCU_Taiwan", "Aachen", "XMU-China", "Mingdao", "Dundee", "Graz", "NTHU_Taiwan", "Tongji_Shanghai"], "NEFU_China": ["NEU-China", "SJTU-Software", "BioBricks"], "NEU-China": ["Jilin_China", "FAFU-CHINA", "BioBricks", "NAU-CHINA", "NEFU_China"], "NJU-China": ["SCUT-China", "NUDT_CHINA", "SCU-China", "JSNU-China", "SYSU-Software"], "NKU_China": ["Jilin_China", "AHUT_China", "UCAS", "JSNU_CHINA", "TJUSLS_China", "Tianjin", "HFUT-China"], "NTHU_Taiwan": ["HSiTAIWAN", "NCTU_Formosa"], "NTU-Singapore": ["Macquarie_Australia", "NUS_Singapore"], "NUDT_CHINA": [], "NUS_Singapore": ["Hong_Kong_HKU", "NTU-Singapore", "Hong_Kong_HKUST", "Melbourne"], "NWPU": ["SYSU-CHINA", "FAFU-CHINA", "HUST-China", "Peking", "Lanzhou", "HZAU-China", "Tianjin"], "NYMU-Taipei": ["HSiTAIWAN"], "NYU-AD": ["AHUT_China"], "OUC-China": ["CIEI-BJ", "BioBricks", "Peking", "XMU-China", "HFUT-China"], "Peking": ["Jilin_China", "Tsinghua", "BHU_China", "BIT-China", "Tianjin", "UCAS", "Tsinghua-A", "OUC-China", "BNU-China"], "Peshawar": ["IIT_Kharagpur", "IIT-Madras", "Tec-Chihuahua", "NCTU_Formosa"], "SCAU-China": ["Peking", "GDSYZX-United"], "SCU-China": ["FAFU-CHINA", "TMMU_China", "SCAU-China", "SCUT-China"], "ShanghaitechChina": ["Concordia", "JSNU-China", "Tsinghua", "Tsinghua-A"], "ShanghaiTechChina_B": ["SYSU-MEDICINE", "ShanghaitechChina", "FAFU-CHINA"], "Shenzhen_SFLS": [], "SJTU-BioX-Shanghai": [], "SJTU-Software": ["BIT", "UT-Tokyo"], "SMS_Shenzhen": [], "SRM_Chennai": [], "SUSTech_Shenzhen": [], "SVCE_CHENNAI": ["Kent", "Tec-Chihuahua", "Aachen", "Oxford", "UPO-Sevilla", "IISc_Bangalore", "Virginia", "IIT-Madras", "Warwick", "Purdue"], "Sydney_Australia": [], "SYSU-CHINA": [], "SYSU-MEDICINE": ["SYSU-CHINA", "AHUT_China", "ShanghaiTechChina_B", "TMMU_China", "NEU-China", "NAU-CHINA", "XMU-China"], "SYSU-Software": [], "SZU-China": ["SYSU-CHINA", "FAFU-CHINA", "SMS_Shenzhen", "BioBricks", "SUSTech_Shenzhen", "XMU-China"], "TAS_Taipei": ["ASIJ_Tokyo", "NYMU-Taipei"], "TCU_Taiwan": [], "Technion_Israel": ["TU-Eindhoven", "Peshawar", "Aachen", "BioBricks"], "Tel-Hai": ["Groningen", "Manchester", "Stockholm", "Freiburg"], "Tianjin": ["Jilin_China", "UCAS", "Virginia", "Valencia_UPV", "Pittsburgh"], "TJUSLS_China": ["NKU_China", "Tianjin"], "TMMU_China": ["SCUT-China", "Nanjing-China", "USTC-Software", "UESTC-China", "SCU-China", "UESTC-software", "SCAU-China"], "Tokyo_Tech": ["Kyoto", "Gifu", "KAIT_Japan", "UT-Tokyo", "EPFL", "ASIJ_Tokyo"], "Tongji_Shanghai": ["Fudan", "NCTU_Formosa"], "Tsinghua": ["BioBricks", "SDSZ_CHINA", "Tsinghua-A"], "Tsinghua-A": [], "UCAS": ["Nanjing-China", "Peking", "BNDS_China", "BIT-China", "XMU-China", "Tianjin"], "UESTC-China": [], "UESTC-software": ["AHUT_China", "SCUT-China", "UESTC-China", "TMMU_China", "Nanjing-China", "USTC-Software", "SCU-China", "SCAU-China"], "UI-Indonesia": [], "UNSW_Australia": ["Northwestern", "Paris_Bettencourt", "Sydney_Australia"], "UoA_NewZealand": [], "USTC": ["USTC-Software", "BIT"], "USTC-Software": ["SJTU-Software", "HFUT-China", "USTC"], "UST_Beijing": ["Tsinghua-A", "Tsinghua"], "UT-Tokyo": ["Nagahama", "Gifu", "Tokyo_Tech", "Kyoto"], "XJTLU-CHINA": ["BIT-China", "BioBricks"], "XMU-China": ["EPFL", "Groningen", "Cornell_NY", "Evry", "Imperial_College", "Paris_Saclay", "HFUT-China", "BGU_ISRAEL", "SJTU-Software", "Virginia", "Tel-Hai", "Oxford", "Lanzhou", "Peshawar", "Exeter", "Pasteur_Paris", "LMU-TUM_Munich"], "ZJU-China": [], "Aachen": ["FAU_Erlangen", "Hannover", "MIT", "Marburg", "BioBricks", "Bielefeld-CeBiTec", "Technion_Israel", "Freiburg", "TU_Darmstadt"], "Aalto-Helsinki": [], "Aix-Marseille": [], "ATOMS_Turkiye": [], "AUC_TURKEY": [], "BGU_ISRAEL": ["Tel-Hai", "Manchester", "XMU-China"], "Bielefeld-CeBiTec": ["SDU-Denmark", "Hannover", "Aachen", "Dundee", "Marburg", "Lethbridge", "Goettingen", "BioBricks", "Exeter", "Tuebingen", "Freiburg", "Duesseldorf"], "Bilkent-UNAMBG": ["Istanbul_Tech"], "Bordeaux": ["Tel-Hai", "Aix-Marseille", "EPFL", "INSA-Lyon"], "Bulgaria": ["Vilnius-Lithuania", "Ionis_Paris", "Goettingen", "Groningen"], "Cambridge-JIC": ["Imperial_College"], "Cardiff_Wales": ["WashU_StLouis", "Warwick", "Oxford", "Paris_Saclay", "Washington", "Toronto"], "Chalmers_Gothenburg": ["Purdue", "Manchester", "Istanbul_Tech"], "CLSB-UK": ["Dundee_Schools", "UCL", "Dundee", "Imperial_College"], "DTU-Denmark": ["Uppsala", "Chalmers_Gothenburg", "Stockholm", "BioBricks", "SDU-Denmark", "Evry"], "Duesseldorf": ["BioBricks", "Aachen", "Marburg"], "Dundee": ["Newcastle", "UCL", "Sheffield"], "Dundee_Schools": ["Newcastle", "Edinburgh_OG", "Edinburgh_UG", "Glasgow", "Dundee", "Sheffield"], "Edinburgh_OG": ["Newcastle", "BioBricks"], "Edinburgh_UG": [], "EPFL": ["Tec-Chihuahua", "Leiden", "TU-Eindhoven", "Tokyo_Tech", "OLS_Canmore", "XMU-China", "Evry"], "ETH_Zurich": ["UI-Indonesia", "NTU-Singapore", "Stockholm", "EPFL", "Freiburg", "TU_Darmstadt"], "Evry": ["Purdue", "Manchester", "XMU-China", "Imperial_College", "TU-Eindhoven", "Paris_Saclay", "Paris_Bettencourt", "Virginia"], "Exeter": ["BioBricks", "Stanford-Brown", "Newcastle", "Purdue", "Glasgow"], "FAU_Erlangen": ["Marburg", "Aachen"], "Freiburg": ["BioBricks", "Evry", "Tel-Hai", "UBonn_HBRS", "ETH_Zurich", "Bielefeld-CeBiTec", "Virginia", "XMU-China", "Pasteur_Paris", "Technion_Israel"], "Glasgow": ["BioBricks", "Exeter"], "Goettingen": ["Hannover", "TU_Darmstadt", "Aachen"], "Groningen": [], "Hamburg": ["Marburg"], "Hannover": ["Leiden", "XMU-China", "Marburg", "SDU-Denmark"], "Imperial_College": ["Evry", "NRP-UEA-Norwich", "UCL", "XMU-China", "CGU_Taiwan", "British_Columbia"], "INSA-Lyon": ["Edinburgh_UG", "Paris_Bettencourt", "UCL", "Bordeaux"], "Ionis_Paris": ["Evry", "EPFL"], "Istanbul_Tech": ["Washington", "Virginia"], "Judd_UK": [], "Kent": ["Manchester", "UCL", "XMU-China", "Virginia"], "Leicester": [], "Leiden": [], "Linkoping_Sweden": [], "LMU-TUM_Munich": ["BioBricks", "Evry", "Marburg", "BIT", "Slovenia", "FAU_Erlangen", "TU_Darmstadt", "Freiburg", "Groningen", "XMU-China", "Sheffield"], "Manchester": ["Chalmers_Gothenburg", "Virginia", "Paris_Saclay"], "Marburg": ["Lethbridge"], "METU_HS_Ankara": ["TU-Eindhoven", "Groningen", "Aachen", "XMU-China", "Harvard_BioDesign", "Tokyo_Tech"], "Newcastle": ["Leiden", "Evry", "Exeter", "BIT", "Edinburgh_UG"], "NRP-UEA-Norwich": ["Imperial_College", "BioBricks", "Kent"], "NTNU_Trondheim": ["Tel-Hai"], "Oxford": ["XMU-China", "Vilnius-Lithuania", "SVCE_CHENNAI"], "Paris_Bettencourt": ["Macquarie_Australia", "Evry", "IIT-Madras", "Valencia_UPV", "UNSW_Australia", "SZU-China", "Ionis_Paris", "LMU-TUM_Munich", "Groningen", "UPF-CRG_Barcelona", "INSA-Lyon", "Pasteur_Paris", "EPFL", "Paris_Saclay"], "Paris_Saclay": ["Valencia_UPV", "ETH_Zurich", "Tsinghua-A", "UiOslo_Norway", "Warwick", "Purdue", "Virginia", "Manchester", "SJTU-BioX-Shanghai", "Groningen", "Sheffield", "EPFL", "Evry", "Tsinghua", "Aalto-Helsinki", "USTC", "Tianjin", "Nagahama", "SYSU-CHINA", "XMU-China", "Bordeaux", "ZJU-China"], "Pasteur_Paris": ["Evry", "Pittsburgh", "Valencia_UPV", "Tianjin", "Virginia", "Paris_Bettencourt", "Freiburg", "Groningen", "Aix-Marseille", "Ionis_Paris", "EPFL", "ULV-LC-CV", "Paris_Saclay"], "SDU-Denmark": ["Stockholm", "Virginia"], "Sheffield": ["Evry", "Groningen", "Aachen", "Westminster_UoW", "Warwick"], "Slovenia": [], "Stockholm": [], "Tonbridge": [], "Toulouse_France": ["Imperial_College", "Evry", "Hamburg", "Tec-Monterrey", "BIT", "Purdue", "Leiden", "Bordeaux", "Aix-Marseille"], "TrinityCollegeDublin": [], "TU-Eindhoven": ["BioBricks", "Evry", "Groningen", "EPFL", "Technion_Israel", "Virginia"], "Tuebingen": ["Marburg", "Duesseldorf"], "TU_Darmstadt": ["Aix-Marseille", "Aachen", "NTNU_Trondheim", "FAU_Erlangen"], "TU_Delft": ["BioBricks", "Wageningen_UR", "Aachen", "Aalto-Helsinki", "BIT", "Virginia", "TU-Eindhoven", "Groningen", "Oxford", "NCTU_Formosa", "Aix-Marseille", "Pasteur_Paris"], "UAM_Poznan": ["LMU-TUM_Munich", "Evry"], "UBonn_HBRS": [], "UCC_Ireland": ["Exeter"], "UCL": ["Rice", "Dundee", "Tianjin", "Dundee_Schools", "CLSB-UK", "Paris_Bettencourt", "XMU-China", "Exeter"], "UCLouvain": ["UCL", "Aalto-Helsinki"], "UGent_Belgium": ["BIT", "Groningen", "EPFL", "Virginia"], "UiOslo_Norway": [], "UNIK_Copenhagen": ["Imperial_College", "BIT", "SDU-Denmark", "Leiden", "XMU-China", "DTU-Denmark", "Stockholm", "Uppsala"], "UPF-CRG_Barcelona": ["BIT", "Paris_Bettencourt", "UPO-Sevilla"], "UPO-Sevilla": ["SVCE_CHENNAI", "UPF-CRG_Barcelona", "Valencia_UPV"], "Uppsala": ["DTU-Denmark", "Aalto-Helsinki", "Stockholm"], "Valencia_UPV": ["Pittsburgh", "UPO-Sevilla", "Warwick", "Purdue", "Virginia", "Groningen", "Hannover", "UPF-CRG_Barcelona", "EPFL", "Paris_Saclay", "Evry", "Aachen", "Tianjin", "Georgia_State", "Paris_Bettencourt", "LMU-TUM_Munich", "XMU-China", "Vilnius-Lithuania", "Goettingen"], "Vilnius-Lithuania": ["WashU_StLouis", "Tel-Hai", "Aachen", "Tec-Monterrey", "Peshawar", "Virginia", "Paris_Bettencourt", "XMU-China", "Austin_UTexas_LASA", "Oxford", "Bulgaria", "Vanderbilt", "Washington"], "Wageningen_UR": ["BioBricks", "Groningen"], "Warwick": ["Manchester", "Sheffield"], "Westminster_UoW": [], "BIOSINT_Mexico": ["BioBricks", "BIT", "Tec-Monterrey"], "ColegioFDR_Peru": [], "Liceo_Eugenio_Hostos": [], "Saint_Rose_School_B": [], "Tec-Chihuahua": ["SVCE_CHENNAI", "Peshawar", "Tec-Monterrey", "Virginia"], "TEC-Costa_Rica": ["USP-EEL-Brazil", "Edinburgh_OG", "EPFL", "Vilnius-Lithuania"], "Tec-Monterrey": ["BioBricks", "Aix-Marseille", "Tec-Chihuahua", "Paris_Saclay"], "TEC_GenetiX_CCM": ["Tec-Monterrey"], "UFAM-UEA_Brazil": [], "UPIBI-IPN": [], "USP-EEL-Brazil": ["Valencia_UPV", "Pasteur_Paris", "Tianjin", "Toulouse_France", "NTU-Singapore", "Virginia", "UBonn_HBRS", "Bordeaux", "Pittsburgh"], "Alverno_CA": [], "Arizona_State": [], "Austin_UTexas": ["Rice", "BioBricks", "Tec-Monterrey"], "Austin_UTexas_LASA": [], "BioBricks": [], "BostonU": ["MIT", "UESTC-software", "SJTU-Software", "USTC-Software", "SYSU-Software", "Northwestern", "BostonU_HW"], "BostonU_HW": [], "British_Columbia": ["Imperial_College", "Virginia", "EPFL"], "CCA_SanDiego": ["Nanjing_NFLS"], "Central-Calgary": [], "CoLite-West-Point": [], "ColumbiaU_NYC": [], "Concordia": ["Graz", "Toronto"], "Cornell_NY": ["Cambridge-JIC", "Virginia"]}
word_freqs = {"Ethiopia1": {}, "Pretoria_UP": {"bacteriophage": 1, "yeast": 1, "mining": 7, "tobacco": 1, "biomaterial": 1, "cyanobacteria": 3, "pollutants": 1}, "AHUT_China": {"biofilm": 5, "recycling": 1, "recombinant": 3, "pathogen": 3, "virus": 1, "vaccine": 1, "cancer": 1}, "ASIJ_Tokyo": {"biodegradation": 5, "recycling": 2, "bioremediation": 3}, "BHU_China": {}, "BIT": {"cancer": 100, "radiation": 2, "immunotherapy": 1, "progesterone": 1, "biosensor": 2, "pollutants": 2, "malaria": 4, "parasite": 1, "chitin": 2}, "BIT-China": {"bioremediation": 5, "crispr": 11, "yeast": 2, "biocatalysis": 1, "fish": 4, "bacteriophage": 1}, "BNDS_China": {}, "BNU-China": {"cancer": 151, "recombinant": 17, "yeast": 20}, "CGU_Taiwan": {"vaccine": 497, "parasite": 3, "malaria": 43, "antibodies": 7, "virus": 21, "biosynthesis": 11, "pathogen": 1, "recombinant": 1, "cancer": 20, "hiv": 20, "biodegradation": 1}, "CIEI-BJ": {"biosynthesis": 15, "moon": 2, "cancer": 4, "yeast": 1, "recombinant": 1, "hiv": 1}, "CPU_CHINA": {}, "FAFU-CHINA": {}, "Fudan": {}, "GDSYZX-United": {"biosynthesis": 1, "recombinant": 6}, "Gifu": {"recombinant": 70, "corrosion": 10, "biosynthesis": 10, "yeast": 25, "pathogen": 10}, "HFUT-China": {"crispr": 2, "yeast": 1}, "HokkaidoU_Japan": {"recombinant": 10, "radiation": 1, "oil": 1, "cancer": 1}, "Hong_Kong_HKU": {"cancer": 1}, "Hong_Kong_HKUST": {"mining": 3, "biosensor": 4, "parasite": 1}, "Hong_Kong_UCCKE": {"radiation": 14, "pollutants": 1}, "HSiTAIWAN": {"biosensor": 134, "parasite": 12, "oil": 2, "cancer": 5, "carcinogenic": 1}, "HUST-China": {"bacteriophage": 17, "radiation": 1, "microbiota": 2, "crispr": 1, "yeast": 47, "recombinant": 3, "oil": 2, "antibodies": 1, "nanotechnology": 3, "fish": 1}, "HZAU-China": {"optogenetics": 13, "histidine": 2, "oscillations": 5, "moon": 4, "oil": 2, "virus": 1}, "IISc_Bangalore": {"cancer": 4, "recombinant": 3, "antibodies": 1, "bacteriophage": 2, "biosynthesis": 2}, "IIT-Madras": {"cancer": 3, "insecticides": 4, "radiation": 1, "crispr": 1, "oscillations": 1}, "IIT_Delhi": {"oscillations": 32, "optogenetics": 2, "crispr": 1}, "IIT_Kharagpur": {"hiv": 41, "histidine": 8, "oil": 4, "recombinant": 1}, "India-Thapar-CSED": {}, "Jilin_China": {"cancer": 30, "antibodies": 3, "recombinant": 1, "immunotherapy": 1}, "JNFLS_China": {"yeast": 2}, "JSNU-China": {"cancer": 177, "recombinant": 5, "antibodies": 15, "nanotechnology": 4}, "KAIT_Japan": {}, "KoreaSonyeodul": {"yeast": 1, "fish": 1, "pollutants": 2, "recycling": 2, "oil": 2}, "Korea_U_Seoul": {"bioenergy": 1, "crispr": 1, "biofilm": 1, "coculture": 2, "yeast": 1}, "Kyoto": {"virus": 9, "antibodies": 9, "bioremediation": 1, "oil": 1, "crispr": 1, "immunotherapy": 1, "cancer": 1}, "Lanzhou": {"microbiota": 7, "fish": 56, "oil": 1, "bioremediation": 1, "recombinant": 5, "biosensor": 6, "cancer": 2, "crispr": 1}, "LN-Shiyan-China": {"histidine": 5}, "Macquarie_Australia": {"biosynthesis": 70, "crispr": 11, "cyanobacteria": 5, "radiation": 2, "yeast": 7}, "Melbourne": {"cancer": 1, "moon": 1, "yeast": 2}, "Mingdao": {"biosensor": 24, "yeast": 45}, "Nagahama": {"recombinant": 35, "biosynthesis": 4, "biofilm": 1, "yeast": 13, "tobacco": 1}, "Nanjing-China": {"yeast": 7, "recombinant": 13, "bioremediation": 1, "bioenergy": 1}, "Nanjing_NFLS": {"cyanobacteria": 34, "recombinant": 50}, "NAU-CHINA": {"biodegradation": 12, "oscillations": 2, "biosensor": 1, "yeast": 9, "bioremediation": 1, "recombinant": 2, "insecticides": 13, "fish": 1, "corn": 4}, "NCKU_Tainan": {}, "NCL_India": {}, "NCTU_Formosa": {"venom": 27, "biosynthesis": 2, "tobacco": 24, "radiation": 12, "insecticides": 8, "cancer": 1}, "NEFU_China": {"cancer": 6, "recombinant": 2, "tobacco": 1, "virus": 1, "yeast": 4, "oscillations": 2, "vaccine": 3}, "NEU-China": {"crispr": 4, "optogenetics": 1, "biosynthesis": 1, "cancer": 1, "yeast": 14}, "NJU-China": {"cancer": 323, "malaria": 1, "radiation": 7, "immunotherapy": 5, "antibodies": 1, "biosynthesis": 1}, "NKU_China": {"biofilm": 24, "microbiota": 3, "biodegradation": 1, "yeast": 1}, "NTHU_Taiwan": {"cancer": 6, "bioremediation": 8, "crispr": 1, "histidine": 4, "yeast": 3}, "NTU-Singapore": {"crispr": 32, "antibodies": 1, "histidine": 3, "cancer": 10, "virus": 2, "nanotechnology": 1, "radiation": 1}, "NUDT_CHINA": {"cancer": 4, "crispr": 1, "virus": 1}, "NUS_Singapore": {"cancer": 101, "pathogen": 3, "antibodies": 5, "recombinant": 1}, "NWPU": {"moon": 3, "recycling": 3, "crispr": 1, "recombinant": 2, "yeast": 3}, "NYMU-Taipei": {"insecticides": 9, "malaria": 2, "yeast": 3, "pathogen": 2, "cancer": 2, "biofilm": 2, "virus": 2}, "NYU-AD": {"oil": 1, "cancer": 2, "yeast": 1}, "OUC-China": {"bioenergy": 28, "moon": 1, "yeast": 1, "biosynthesis": 1}, "Peking": {"biomaterial": 5, "biocatalysis": 1, "bioremediation": 2, "mining": 9, "corn": 1, "corrosion": 1, "histidine": 1, "recombinant": 3, "radiation": 16, "cancer": 2, "recycling": 1, "hiv": 7, "crispr": 16, "pathogen": 6, "dyes": 2, "malaria": 1, "cholera": 1, "virus": 2, "penicillin": 2, "biosensor": 1, "vaccine": 2}, "Peshawar": {"biosensor": 5, "pollutants": 3, "optogenetics": 1, "cancer": 2, "parasite": 1, "virus": 1, "bioremediation": 1}, "SCAU-China": {"biosynthesis": 25, "yeast": 3, "tobacco": 3, "recombinant": 2, "cancer": 1, "chitin": 3, "oil": 4}, "SCU-China": {"therapeutic": 3, "pathogen": 16, "recombinant": 6, "biosynthesis": 3, "malaria": 1, "crispr": 16, "biofilm": 8, "bacteriocin": 8, "parasite": 8}, "ShanghaitechChina": {"biofilm": 158, "recycling": 3, "recombinant": 3, "histidine": 1, "antibodies": 1, "nanomaterial": 4, "cancer": 7}, "ShanghaiTechChina_B": {"therapeutic": 52, "biofilm": 202, "ibd": 527, "microbiota": 38, "nicotine": 9, "cancer": 71, "recombinant": 9, "bacteriophage": 5, "histidine": 4, "antibodies": 4}, "Shenzhen_SFLS": {"vaccine": 1, "biosensor": 1}, "SJTU-BioX-Shanghai": {"yeast": 296, "biosensor": 63, "cancer": 11, "antibodies": 1, "biosynthesis": 1}, "SJTU-Software": {}, "SMS_Shenzhen": {"virus": 1, "oil": 1, "recombinant": 1}, "SRM_Chennai": {"cancer": 17, "crispr": 1}, "SUSTech_Shenzhen": {"optogenetics": 5, "crispr": 1, "oscillations": 1, "nanotechnology": 1}, "SVCE_CHENNAI": {"biosynthesis": 1, "bacteriophage": 1, "cancer": 1, "yeast": 3}, "Sydney_Australia": {"biodegradation": 2, "biosensor": 108, "yeast": 14, "recombinant": 2, "bioremediation": 2, "pollutants": 1, "histidine": 3, "nanotechnology": 1, "dyes": 1}, "SYSU-CHINA": {"cancer": 2}, "SYSU-MEDICINE": {"ibd": 51, "microbiota": 2, "oil": 2, "virus": 3, "telomerase": 16, "therapeutic": 1, "cancer": 14}, "SYSU-Software": {}, "SZU-China": {"cyanobacteria": 1, "yeast": 3, "virus": 2, "moon": 6}, "TAS_Taipei": {"radiation": 3, "fish": 73, "histidine": 16, "nanotechnology": 6, "cancer": 33, "virus": 4}, "TCU_Taiwan": {"recombinant": 2, "biosynthesis": 1}, "Technion_Israel": {"bioremediation": 1, "histidine": 3, "antibodies": 1, "dyes": 1, "cancer": 1}, "Tel-Hai": {"cholera": 19, "cancer": 5, "crispr": 4, "antibodies": 1, "yeast": 1}, "Tianjin": {"recycling": 2, "biodegradation": 25, "recombinant": 22, "cyanobacteria": 20, "bacteriophage": 1, "yeast": 11, "histidine": 2, "biofilm": 2, "biosynthesis": 1, "oil": 2, "vaccine": 4, "fish": 1, "antibodies": 4}, "TJUSLS_China": {"recycling": 4, "biodegradation": 3, "corrosion": 1, "yeast": 47, "dyes": 2, "recombinant": 4}, "TMMU_China": {"recombinant": 6, "pathogen": 1, "cancer": 2, "histidine": 9, "biosynthesis": 3, "vaccine": 1}, "Tokyo_Tech": {"yeast": 8, "recombinant": 1}, "Tongji_Shanghai": {"cancer": 36, "telomerase": 4, "virus": 2, "radiation": 4, "nanotechnology": 1}, "Tsinghua": {"yeast": 26, "cancer": 18, "recombinant": 4, "crispr": 1, "immunotherapy": 2, "penicillin": 3}, "Tsinghua-A": {"malaria": 1, "yeast": 1}, "UCAS": {"virus": 1, "biofilm": 3, "penicillin": 2, "biosensor": 1, "pollutants": 2, "biosynthesis": 1, "bacteriophage": 1}, "UESTC-China": {}, "UESTC-software": {"nanotechnology": 2, "crispr": 2}, "UI-Indonesia": {"hiv": 16, "vaccine": 19, "virus": 3, "crispr": 2}, "UNSW_Australia": {"biosynthesis": 1, "crispr": 26, "yeast": 3, "microbiota": 1, "antibodies": 2, "bioremediation": 6, "cancer": 1, "biodegradation": 1, "biosensor": 2, "vaccine": 1}, "UoA_NewZealand": {"recycling": 4, "nanotechnology": 2, "pollutants": 1, "yeast": 2}, "USTC": {"yeast": 106, "pathogen": 1, "biosynthesis": 1, "cancer": 1, "recombinant": 14, "recycling": 2, "virus": 2, "nanotechnology": 1}, "USTC-Software": {}, "UST_Beijing": {"yeast": 6, "microbiota": 1, "corn": 1}, "UT-Tokyo": {"oil": 10, "yeast": 5, "cancer": 7}, "XJTLU-CHINA": {"bacteriophage": 3, "recombinant": 2, "radiation": 1, "bioenergy": 5, "oil": 15, "yeast": 12}, "XMU-China": {"cholera": 2, "penicillin": 1, "pathogen": 2, "therapeutic": 1, "virus": 1, "bacteriophage": 1, "biocatalysis": 1, "mining": 1}, "ZJU-China": {}, "Aachen": {"oil": 1, "biosensor": 394, "pathogen": 104, "radiation": 29, "dyes": 9, "tobacco": 28, "virus": 46, "cancer": 22, "biosynthesis": 4, "penicillin": 2, "als": 6, "yeast": 58, "recombinant": 2, "histidine": 3, "corn": 4}, "Aalto-Helsinki": {"yeast": 135, "cyanobacteria": 43, "histidine": 2, "antibodies": 2, "biodegradation": 2}, "Aix-Marseille": {"mining": 10, "biosynthesis": 15, "pollutants": 9, "corn": 8}, "ATOMS_Turkiye": {"nanotechnology": 3, "crispr": 1}, "AUC_TURKEY": {"recycling": 3, "crispr": 1}, "BGU_ISRAEL": {"biodegradation": 18, "biofilm": 66, "biocatalysis": 1, "bacteriophage": 1, "yeast": 1, "pollutants": 7, "bioremediation": 2, "recycling": 9, "recombinant": 3, "oil": 2}, "Bielefeld-CeBiTec": {"virus": 67, "antibodies": 304, "fish": 17, "immunotherapy": 18, "biosensor": 2010, "histidine": 57, "yeast": 87, "bacteriophage": 227, "chitin": 145, "pathogen": 17, "cancer": 18, "pollutants": 4, "tobacco": 82, "bioremediation": 7, "bioweapon": 16, "radiation": 1, "penicillin": 2, "cyanobacteria": 19, "recycling": 1, "oil": 30, "moon": 4, "biosynthesis": 3, "mining": 1, "corrosion": 1, "recombinant": 1}, "Bilkent-UNAMBG": {"cancer": 19, "nanotechnology": 13, "biofilm": 1, "yeast": 1}, "Bordeaux": {"immunotherapy": 1, "antibodies": 5, "crispr": 12, "virus": 7, "hiv": 2, "malaria": 2, "vaccine": 3, "tobacco": 3, "yeast": 3, "cancer": 3}, "Bulgaria": {"crispr": 1, "cancer": 1}, "Cambridge-JIC": {"biosynthesis": 2, "antibodies": 2, "crispr": 1, "recombinant": 1, "cyanobacteria": 2}, "Cardiff_Wales": {"cyanobacteria": 1, "crispr": 12, "pathogen": 4, "virus": 4, "hiv": 37, "biosensor": 1}, "Chalmers_Gothenburg": {"biosynthesis": 32, "yeast": 29, "cyanobacteria": 42, "moon": 1, "coculture": 2, "oil": 2, "corn": 2, "bioethanol": 2, "bioweapon": 2, "virus": 2, "bacteriophage": 4, "biofilm": 2}, "CLSB-UK": {"cyanobacteria": 71, "corn": 2, "crispr": 1, "recombinant": 1, "biosynthesis": 1}, "DTU-Denmark": {"biosensor": 58, "corn": 6, "yeast": 16, "oil": 37, "crispr": 5, "biosynthesis": 3, "biodegradation": 1, "pollutants": 1, "recombinant": 1, "tobacco": 1}, "Duesseldorf": {"cancer": 336, "optogenetics": 22, "cyanobacteria": 1, "yeast": 57, "biosynthesis": 2, "virus": 40, "radiation": 17, "immunotherapy": 1}, "Dundee": {"cancer": 1, "bacteriocin": 26, "pathogen": 3}, "Dundee_Schools": {"cholera": 13, "pathogen": 9}, "Edinburgh_OG": {"cyanobacteria": 34, "bioremediation": 11, "yeast": 4, "mining": 7, "bacteriophage": 1, "biosynthesis": 1, "pollutants": 1, "chitin": 1, "oil": 1, "penicillin": 1, "recombinant": 2}, "Edinburgh_UG": {"cancer": 1}, "EPFL": {"cancer": 1, "crispr": 6, "yeast": 234, "biosensor": 4, "antibodies": 1, "oil": 1, "mining": 1}, "ETH_Zurich": {"ibd": 212, "cancer": 2341, "microbiota": 24, "yeast": 40, "crispr": 12, "coculture": 56, "therapeutic": 44, "oil": 43, "antibodies": 29, "penicillin": 24, "recombinant": 12, "radiation": 2, "hiv": 2, "biosynthesis": 4}, "Evry": {"biosynthesis": 104, "biosensor": 74, "recombinant": 9, "yeast": 86, "biodegradation": 12, "bioplastic": 2, "microbiota": 1, "bioremediation": 26, "immunotherapy": 24, "cancer": 72, "pollutants": 43, "corn": 5, "antibodies": 3, "pathogen": 2, "vaccine": 12, "malaria": 1, "penicillin": 1, "mining": 3, "fish": 6, "recycling": 2, "virus": 1, "oil": 3, "coculture": 1}, "Exeter": {"crispr": 32, "cancer": 1, "biosensor": 12, "virus": 6, "pathogen": 1, "biosynthesis": 4, "bacteriophage": 2, "yeast": 5}, "FAU_Erlangen": {"oil": 11, "biofilm": 301, "dyes": 20, "cancer": 8}, "Freiburg": {"ibd": 2, "antibodies": 57, "cancer": 39, "microbiota": 3, "biocatalysis": 1, "vaccine": 1, "biodegradation": 1, "yeast": 2, "virus": 2, "radiation": 6, "bioremediation": 1, "crispr": 1, "biosensor": 3}, "Glasgow": {"biosynthesis": 9, "corn": 2, "biosensor": 1}, "Goettingen": {"cancer": 1, "biosynthesis": 2, "antibodies": 6, "yeast": 19, "recombinant": 6, "crispr": 1}, "Groningen": {}, "Hamburg": {"pathogen": 11, "nanotechnology": 5, "biosensor": 4, "biosynthesis": 4, "oil": 21, "yeast": 27, "antibodies": 21, "recombinant": 2, "malaria": 2, "hiv": 8, "vaccine": 8}, "Hannover": {"virus": 4, "cancer": 10, "recombinant": 3, "tobacco": 3, "antibodies": 6}, "Imperial_College": {"bacteriophage": 14, "oscillations": 17, "yeast": 23, "virus": 5, "nanotechnology": 3, "fish": 2, "biosensor": 1, "optogenetics": 2, "bioremediation": 2, "penicillin": 2, "cyanobacteria": 11, "radiation": 2}, "INSA-Lyon": {"cancer": 3, "antibodies": 7, "pollutants": 2, "hiv": 90, "virus": 7, "telomerase": 3, "pathogen": 2, "contraceptive": 2, "biosensor": 1, "crispr": 1}, "Ionis_Paris": {"pollutants": 33, "biosensor": 100, "yeast": 7, "biodegradation": 1, "dyes": 1, "vaccine": 1, "nanotechnology": 1, "cancer": 1}, "Istanbul_Tech": {"biosensor": 8, "cancer": 3, "mining": 1, "antibodies": 2}, "Judd_UK": {}, "Kent": {"biosynthesis": 1, "pathogen": 1, "oil": 1, "cancer": 3, "biosensor": 1, "crispr": 1, "cyanobacteria": 1}, "Leicester": {"crispr": 3, "radiation": 1, "dyes": 1, "cancer": 1}, "Leiden": {"moon": 2}, "Linkoping_Sweden": {}, "LMU-TUM_Munich": {"optogenetics": 4, "recombinant": 3, "biomanufacturing": 1, "antibodies": 26, "als": 8, "biosensor": 3, "crispr": 1, "immunotherapy": 2, "dyes": 2, "cancer": 14, "oil": 2, "radiation": 2, "therapeutic": 2, "yeast": 2, "histidine": 2, "penicillin": 2, "moon": 6, "virus": 7}, "Manchester": {"biosensor": 8, "biocatalysis": 1, "antibodies": 2, "tobacco": 6, "dyes": 1, "bioenergy": 4}, "Marburg": {"cancer": 6, "biosynthesis": 6, "yeast": 46, "virus": 1, "pathogen": 1, "oil": 1, "radiation": 2}, "METU_HS_Ankara": {"cancer": 211, "yeast": 2, "coculture": 2, "antibodies": 1, "carcinogenic": 1, "radiation": 2, "fish": 2}, "Newcastle": {"yeast": 83, "radiation": 1, "cyanobacteria": 4, "oil": 1}, "NRP-UEA-Norwich": {"bioenergy": 1, "cancer": 1, "yeast": 1, "antibodies": 1}, "NTNU_Trondheim": {"cancer": 4, "crispr": 2}, "Oxford": {"therapeutic": 14, "als": 2, "biosensor": 29, "microbiota": 5, "penicillin": 1, "pathogen": 8, "histidine": 12, "yeast": 6, "cancer": 4, "recombinant": 1, "malaria": 2}, "Paris_Bettencourt": {"bioremediation": 11, "pollutants": 3, "mining": 1, "histidine": 2, "dyes": 2, "cancer": 2, "textiles": 2, "recombinant": 2, "oil": 1, "cyanobacteria": 1, "pathogen": 1, "chitin": 1, "yeast": 1}, "Paris_Saclay": {"crispr": 19, "recombinant": 3, "virus": 14, "cancer": 3, "als": 2, "bacteriophage": 2, "oil": 3, "corn": 1, "yeast": 1, "bioenergy": 1, "fish": 5}, "Pasteur_Paris": {"insecticides": 10, "antibodies": 18, "pathogen": 6, "malaria": 1, "virus": 5, "vaccine": 1, "histidine": 2, "oil": 3, "recombinant": 4}, "SDU-Denmark": {"bacteriocin": 300, "biofilm": 20, "recombinant": 20, "biodegradation": 4, "radiation": 8, "biosynthesis": 19, "textiles": 10, "chitin": 51, "yeast": 10, "pathogen": 2, "penicillin": 19, "microbiota": 1, "cancer": 23, "antibodies": 103, "immunotherapy": 2, "vaccine": 3, "therapeutic": 2, "venom": 2, "histidine": 4}, "Sheffield": {"antibodies": 1, "histidine": 2, "yeast": 4, "virus": 2, "dyes": 4, "hiv": 1, "malaria": 1, "oil": 1}, "Slovenia": {"cancer": 1, "optogenetics": 7, "fish": 1, "antibodies": 24, "dyes": 17, "tobacco": 2, "virus": 6, "yeast": 1, "nanotechnology": 4, "histidine": 1, "bacteriophage": 1, "biomaterial": 1, "cyanobacteria": 1}, "Stockholm": {}, "Tonbridge": {}, "Toulouse_France": {"microbiota": 10, "chitin": 10, "yeast": 3, "biocatalysis": 1}, "TrinityCollegeDublin": {}, "TU-Eindhoven": {"tobacco": 2, "yeast": 1, "histidine": 1, "radiation": 2, "cancer": 20}, "Tuebingen": {"therapeutic": 2, "yeast": 13, "crispr": 1, "histidine": 1, "virus": 1, "bacteriophage": 1}, "TU_Darmstadt": {"radiation": 6, "cancer": 3, "biosensor": 8, "biosynthesis": 10, "corn": 1}, "TU_Delft": {"oil": 147, "radiation": 54, "yeast": 23, "recombinant": 11, "dyes": 11, "virus": 10, "moon": 10, "biofilm": 1579, "corrosion": 38, "pathogen": 30, "cyanobacteria": 140, "bioremediation": 10, "antibodies": 21, "nanotechnology": 15}, "UAM_Poznan": {"bacteriophage": 8, "biosynthesis": 8, "recombinant": 2, "yeast": 5, "antibodies": 1, "cancer": 1, "virus": 2, "hiv": 1, "bioremediation": 1}, "UBonn_HBRS": {"recycling": 2}, "UCC_Ireland": {"vaccine": 186, "cancer": 36, "parasite": 16, "pathogen": 3, "antibodies": 5, "immunotherapy": 3, "crispr": 6, "penicillin": 2, "radiation": 2, "therapeutic": 2, "virus": 1, "malaria": 16}, "UCL": {"cancer": 5, "virus": 18, "telomerase": 2, "biofilm": 6, "bacteriocin": 16, "biosynthesis": 17, "histidine": 3, "pathogen": 5, "radiation": 1, "yeast": 9, "recombinant": 3, "hiv": 1, "crispr": 1, "oscillations": 3, "antibodies": 1, "microbiota": 2, "biosensor": 1}, "UCLouvain": {"bacteriophage": 5, "penicillin": 1, "corn": 9, "recombinant": 1, "histidine": 4, "yeast": 2}, "UGent_Belgium": {"yeast": 1, "antibodies": 6, "biocatalysis": 1, "crispr": 1}, "UiOslo_Norway": {"nanotechnology": 4, "cancer": 3, "penicillin": 5}, "UNIK_Copenhagen": {"moon": 7, "cyanobacteria": 56, "radiation": 30, "bioplastic": 2, "microbiota": 1, "biosynthesis": 3, "yeast": 8, "recycling": 1, "virus": 2, "corn": 1, "cancer": 11, "antibodies": 1, "dyes": 1, "recombinant": 1, "carcinogenic": 1, "nanotechnology": 1}, "UPF-CRG_Barcelona": {"cancer": 269, "carcinogenic": 3, "radiation": 3, "microbiota": 7, "biosynthesis": 4, "yeast": 5, "recombinant": 1, "crispr": 1}, "UPO-Sevilla": {"biofilm": 308, "tobacco": 2, "pollutants": 1, "bioremediation": 8, "textiles": 1, "vaccine": 1, "biosynthesis": 1, "oil": 1, "cancer": 1, "crispr": 1}, "Uppsala": {"crispr": 25, "yeast": 6, "histidine": 3, "oil": 2, "cancer": 4, "pollutants": 2}, "Valencia_UPV": {"nanotechnology": 1, "cyanobacteria": 1, "biosynthesis": 17, "corn": 7, "virus": 97, "tobacco": 26, "oil": 20, "crispr": 16, "fish": 4, "parasite": 5, "cancer": 10, "radiation": 5}, "Vilnius-Lithuania": {"fish": 1, "cyanobacteria": 1, "virus": 1, "bacteriophage": 1, "recombinant": 2, "crispr": 14, "antibodies": 9, "yeast": 18, "cancer": 26, "biosensor": 36, "oil": 2}, "Wageningen_UR": {"virus": 121, "oil": 2, "yeast": 149, "crispr": 27, "pathogen": 41, "bacteriophage": 21, "oscillations": 14, "insecticides": 7, "corn": 2, "histidine": 28, "chitin": 7, "parasite": 1}, "Warwick": {"biosensor": 11, "pollutants": 1, "virus": 3, "crispr": 22, "bacteriophage": 11, "yeast": 1, "nanotechnology": 1, "antibodies": 2}, "Westminster_UoW": {}, "BIOSINT_Mexico": {"biosynthesis": 30, "yeast": 12}, "ColegioFDR_Peru": {}, "Liceo_Eugenio_Hostos": {}, "Saint_Rose_School_B": {"yeast": 26, "fish": 5, "pollutants": 5, "bacteriophage": 1}, "Tec-Chihuahua": {"biosensor": 6, "nanotechnology": 1, "penicillin": 1}, "TEC-Costa_Rica": {"cancer": 32, "yeast": 2, "biosensor": 1, "crispr": 3}, "Tec-Monterrey": {"vaccine": 2, "pollutants": 1, "recycling": 7, "mining": 5, "pathogen": 1, "cancer": 1}, "TEC_GenetiX_CCM": {"bioremediation": 2, "dyes": 2, "pollutants": 1, "cancer": 11, "biosensor": 6, "progesterone": 1, "biodegradation": 2, "recycling": 3, "recombinant": 1, "nanotechnology": 6, "yeast": 1}, "UFAM-UEA_Brazil": {"mining": 1, "bioremediation": 1}, "UPIBI-IPN": {}, "USP-EEL-Brazil": {"corrosion": 1, "oil": 16, "biosynthesis": 3, "yeast": 2, "bioenergy": 2}, "Alverno_CA": {}, "Arizona_State": {}, "Austin_UTexas": {"yeast": 73, "tobacco": 1, "cancer": 1, "biosynthesis": 1, "microbiota": 1}, "Austin_UTexas_LASA": {"cancer": 2, "insecticides": 4, "crispr": 1}, "BioBricks": {}, "BostonU": {"cancer": 17, "immunotherapy": 7, "crispr": 5, "malaria": 2, "virus": 1, "antibodies": 1, "yeast": 2}, "BostonU_HW": {}, "British_Columbia": {"recombinant": 6, "antibodies": 2, "virus": 2, "vaccine": 4, "biosynthesis": 6, "cancer": 2, "crispr": 8}, "CCA_SanDiego": {"pollutants": 1, "bioremediation": 2, "malaria": 1}, "Central-Calgary": {"crispr": 1}, "CoLite-West-Point": {}, "ColumbiaU_NYC": {"virus": 10, "malaria": 3, "oil": 6, "recombinant": 3, "cancer": 1, "dyes": 1, "biofilm": 1}, "Concordia": {"yeast": 67, "biosensor": 1, "mining": 1, "recombinant": 16, "oil": 5, "biosynthesis": 4, "crispr": 7, "dyes": 2, "nanotechnology": 9, "corn": 1, "radiation": 1, "pollutants": 1, "bioremediation": 1, "cancer": 1}, "Cornell_NY": {"bacteriocin": 19, "bacteriophage": 1, "pathogen": 4, "biofilm": 1, "microbiota": 1, "radiation": 2, "dyes": 1, "cancer": 1, "vaccine": 2, "recombinant": 1}}
for i in word_freqs:
	val = [x for x in word_freqs[i] if word_freqs[i][x] > 5]
	# print(val)
	word_freqs[i] = ", ".join(val)
for i in word_freqs:
	geo_from_json[i]["words"] = word_freqs[i]
print(len(team_collabs))
print(word_freqs)

graph_teams()
print("Finished graphing")
